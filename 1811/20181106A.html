<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【复盘】jQuery实现轮播效果与无缝轮播 | Franko&#39;s Blog</title>
    <meta name="description" content="长江一帆远，落日五湖春。">
    <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.82618647.css" as="style"><link rel="preload" href="/assets/js/app.20586f85.js" as="script"><link rel="preload" href="/assets/js/3.a975d71c.js" as="script"><link rel="preload" href="/assets/js/1.f9715dde.js" as="script"><link rel="preload" href="/assets/js/39.0a74782b.js" as="script"><link rel="prefetch" href="/assets/js/10.3713fa2b.js"><link rel="prefetch" href="/assets/js/100.c7e8673f.js"><link rel="prefetch" href="/assets/js/101.29a59833.js"><link rel="prefetch" href="/assets/js/102.3fbd0f95.js"><link rel="prefetch" href="/assets/js/103.72c6e9b5.js"><link rel="prefetch" href="/assets/js/104.f6f27012.js"><link rel="prefetch" href="/assets/js/105.0d66958f.js"><link rel="prefetch" href="/assets/js/106.290db28e.js"><link rel="prefetch" href="/assets/js/107.e20e3803.js"><link rel="prefetch" href="/assets/js/108.cd45cee0.js"><link rel="prefetch" href="/assets/js/109.4ba3d58f.js"><link rel="prefetch" href="/assets/js/11.3f5de7ee.js"><link rel="prefetch" href="/assets/js/110.0d55c579.js"><link rel="prefetch" href="/assets/js/111.3648d92a.js"><link rel="prefetch" href="/assets/js/112.cf39ecb8.js"><link rel="prefetch" href="/assets/js/113.6f2fdbc4.js"><link rel="prefetch" href="/assets/js/114.77c92b08.js"><link rel="prefetch" href="/assets/js/115.0656b5e6.js"><link rel="prefetch" href="/assets/js/116.80cf31f3.js"><link rel="prefetch" href="/assets/js/117.2b92a260.js"><link rel="prefetch" href="/assets/js/118.c06968f3.js"><link rel="prefetch" href="/assets/js/119.20ab4e08.js"><link rel="prefetch" href="/assets/js/12.19e53560.js"><link rel="prefetch" href="/assets/js/120.97d79ae7.js"><link rel="prefetch" href="/assets/js/121.f6da62ca.js"><link rel="prefetch" href="/assets/js/122.859caf01.js"><link rel="prefetch" href="/assets/js/13.dda8f215.js"><link rel="prefetch" href="/assets/js/14.2a592289.js"><link rel="prefetch" href="/assets/js/15.4925e3a4.js"><link rel="prefetch" href="/assets/js/16.0f840892.js"><link rel="prefetch" href="/assets/js/17.3e801416.js"><link rel="prefetch" href="/assets/js/18.b4d3a92e.js"><link rel="prefetch" href="/assets/js/19.f9cee7a0.js"><link rel="prefetch" href="/assets/js/20.3f33780e.js"><link rel="prefetch" href="/assets/js/21.ed566f24.js"><link rel="prefetch" href="/assets/js/22.94f8e887.js"><link rel="prefetch" href="/assets/js/23.fb38ed6e.js"><link rel="prefetch" href="/assets/js/24.dd36a8c2.js"><link rel="prefetch" href="/assets/js/25.bb6cacf5.js"><link rel="prefetch" href="/assets/js/26.c86a26fa.js"><link rel="prefetch" href="/assets/js/27.2dd1516a.js"><link rel="prefetch" href="/assets/js/28.83a01027.js"><link rel="prefetch" href="/assets/js/29.fcd25cd4.js"><link rel="prefetch" href="/assets/js/30.a1c1c82d.js"><link rel="prefetch" href="/assets/js/31.274c9b5e.js"><link rel="prefetch" href="/assets/js/32.f75d4ae9.js"><link rel="prefetch" href="/assets/js/33.1e4d92da.js"><link rel="prefetch" href="/assets/js/34.4ef7ac99.js"><link rel="prefetch" href="/assets/js/35.4f47ea1f.js"><link rel="prefetch" href="/assets/js/36.f1911a7c.js"><link rel="prefetch" href="/assets/js/37.b562ea4c.js"><link rel="prefetch" href="/assets/js/38.b862a71d.js"><link rel="prefetch" href="/assets/js/4.46f5c0e2.js"><link rel="prefetch" href="/assets/js/40.f75bdd02.js"><link rel="prefetch" href="/assets/js/41.62a05ca3.js"><link rel="prefetch" href="/assets/js/42.1a733cf6.js"><link rel="prefetch" href="/assets/js/43.7506e026.js"><link rel="prefetch" href="/assets/js/44.568d2265.js"><link rel="prefetch" href="/assets/js/45.50e5cd0c.js"><link rel="prefetch" href="/assets/js/46.2c3c32c9.js"><link rel="prefetch" href="/assets/js/47.f9a54e6b.js"><link rel="prefetch" href="/assets/js/48.32da44eb.js"><link rel="prefetch" href="/assets/js/49.df6b0b62.js"><link rel="prefetch" href="/assets/js/5.bb6aabf2.js"><link rel="prefetch" href="/assets/js/50.52d40ed6.js"><link rel="prefetch" href="/assets/js/51.e7a7badb.js"><link rel="prefetch" href="/assets/js/52.6a20c4e8.js"><link rel="prefetch" href="/assets/js/53.2747af5b.js"><link rel="prefetch" href="/assets/js/54.02396d0d.js"><link rel="prefetch" href="/assets/js/55.7b929339.js"><link rel="prefetch" href="/assets/js/56.f24df74e.js"><link rel="prefetch" href="/assets/js/57.a39d5e97.js"><link rel="prefetch" href="/assets/js/58.b13862f5.js"><link rel="prefetch" href="/assets/js/59.b2ef3cb1.js"><link rel="prefetch" href="/assets/js/6.9a323443.js"><link rel="prefetch" href="/assets/js/60.3b294663.js"><link rel="prefetch" href="/assets/js/61.23d3575f.js"><link rel="prefetch" href="/assets/js/62.9c1cd3c8.js"><link rel="prefetch" href="/assets/js/63.4376c00d.js"><link rel="prefetch" href="/assets/js/64.59741dd5.js"><link rel="prefetch" href="/assets/js/65.8e59eee4.js"><link rel="prefetch" href="/assets/js/66.a07156ca.js"><link rel="prefetch" href="/assets/js/67.bad8de6a.js"><link rel="prefetch" href="/assets/js/68.348f3c6f.js"><link rel="prefetch" href="/assets/js/69.27403668.js"><link rel="prefetch" href="/assets/js/7.7376f609.js"><link rel="prefetch" href="/assets/js/70.e105d08d.js"><link rel="prefetch" href="/assets/js/71.3912c588.js"><link rel="prefetch" href="/assets/js/72.2e803182.js"><link rel="prefetch" href="/assets/js/73.698bb062.js"><link rel="prefetch" href="/assets/js/74.6eb02d59.js"><link rel="prefetch" href="/assets/js/75.5e85377b.js"><link rel="prefetch" href="/assets/js/76.a50ad35f.js"><link rel="prefetch" href="/assets/js/77.9923eba2.js"><link rel="prefetch" href="/assets/js/78.30d80868.js"><link rel="prefetch" href="/assets/js/79.b0633c2f.js"><link rel="prefetch" href="/assets/js/8.effb8ee5.js"><link rel="prefetch" href="/assets/js/80.1c7129b4.js"><link rel="prefetch" href="/assets/js/81.757e25f5.js"><link rel="prefetch" href="/assets/js/82.04a6c134.js"><link rel="prefetch" href="/assets/js/83.a5425512.js"><link rel="prefetch" href="/assets/js/84.478c64ab.js"><link rel="prefetch" href="/assets/js/85.e304024e.js"><link rel="prefetch" href="/assets/js/86.46d38efd.js"><link rel="prefetch" href="/assets/js/87.8ab01c2a.js"><link rel="prefetch" href="/assets/js/88.695a06d9.js"><link rel="prefetch" href="/assets/js/89.2b9afe77.js"><link rel="prefetch" href="/assets/js/9.a3297750.js"><link rel="prefetch" href="/assets/js/90.6dd7f214.js"><link rel="prefetch" href="/assets/js/91.891f6634.js"><link rel="prefetch" href="/assets/js/92.32bd7ffa.js"><link rel="prefetch" href="/assets/js/93.646030b0.js"><link rel="prefetch" href="/assets/js/94.2df43ae3.js"><link rel="prefetch" href="/assets/js/95.ca4e89a0.js"><link rel="prefetch" href="/assets/js/96.4b4fcf2a.js"><link rel="prefetch" href="/assets/js/97.705f40c5.js"><link rel="prefetch" href="/assets/js/98.3035542d.js"><link rel="prefetch" href="/assets/js/99.40877126.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82618647.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Franko's Blog</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/笔记.html" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/category/随笔.html" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/category/项目总结.html" class="nav-link"><i class="iconfont undefined"></i>
  项目总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读书记录.html" class="nav-link"><i class="iconfont undefined"></i>
  读书记录
</a></li><li class="dropdown-item"><!----> <a href="/category/翻译.html" class="nav-link"><i class="iconfont undefined"></i>
  翻译
</a></li><li class="dropdown-item"><!----> <a href="/category/关于我.html" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/笔记.html" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/category/随笔.html" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/category/项目总结.html" class="nav-link"><i class="iconfont undefined"></i>
  项目总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读书记录.html" class="nav-link"><i class="iconfont undefined"></i>
  读书记录
</a></li><li class="dropdown-item"><!----> <a href="/category/翻译.html" class="nav-link"><i class="iconfont undefined"></i>
  翻译
</a></li><li class="dropdown-item"><!----> <a href="/category/关于我.html" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>2020</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>九月</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2009/20200919A.html" class="sidebar-link">【归纳】代码优化技巧与可读性</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>五月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>四月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>三月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>二月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>一月</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2019</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2018</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>【复盘】jQuery实现轮播效果与无缝轮播</h1> <hr> <div data-v-b53d65a4><i class="iconfont reco-account" data-v-b53d65a4><span data-v-b53d65a4>广宇</span></i> <i class="iconfont reco-date" data-v-b53d65a4><span data-v-b53d65a4>2018-11-7</span></i> <!----> <i class="iconfont reco-tag tags" data-v-b53d65a4><span class="tag-item" data-v-b53d65a4>
      JavaScript
    </span><span class="tag-item" data-v-b53d65a4>
      jQuery
    </span></i></div></div> <div class="content__default"><div class="tip custom-block"><p>在学习怎么做轮播之前在课上学了jQuery，大概地自己用原生JS的方法实现了类似jQuery的模式。大概明白jQuery是怎么一回事之后，开始做轮播了。</p></div> <p>在上个星期，我把这个做轮播的任务给完成了，虽然感觉这个都是些没什么好作为博客写出来的，这次就算是对之前的整个过程做一个复盘吧，就算没什么意义，那就当写日记好了。</p><div style="text-align:center;"><img src="20181106A/timg.jpg" alt="轮播"></div><p></p> <h2 id="普通轮播"><a href="#普通轮播" aria-hidden="true" class="header-anchor">#</a> 普通轮播</h2> <p>首先是用jQuery实现轮播。最开始讲了一个内容、样式、行为分离的指导思想，即是由HTML负责内容、CSS负责样式、JS负责行为，三者尽量互不相干。为了提高网页性能和方便团队开发，需要写出清晰、方便、便于查找修改的代码，而且这样写出来的代码也能够减少维护成本，提高可读性和兼容性。</p> <p>这次的轮播的要求是什么？大概是轮播的图片会自动滚动进行轮播，并且点击图片下方的按钮可以对要展示的图片进行选择，而且当鼠标浮在图片上时会暂停轮播。选择大致地讲一下整个轮播的思路。</p> <h3 id="展示图片"><a href="#展示图片" aria-hidden="true" class="header-anchor">#</a> 展示图片</h3> <p>如何实现轮播？轮播实际上就是几张图片轮流滚动的效果，通过下面的代码，可以通过将包裹几张图片的盒子设置为弹性布局，使图片自动排成一行，并且令图片不会拉伸：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.images</span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span>flex<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span>flex-start<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="jquery的点击事件"><a href="#jquery的点击事件" aria-hidden="true" class="header-anchor">#</a> jQuery的点击事件</h3> <p>然后要做到点击图片下方放置的button达到选择图片的效果。这时候就要用到jQuery的点击事件了。点击按钮后修改包裹图片的盒子的样式，将其水平位置进行修改：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> buttons <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#buttons &gt; button'</span><span class="token punctuation">)</span>            <span class="token comment">//获取四个按键</span>

buttons<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                 <span class="token comment">//按钮点击事件</span>
    <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>currentTarget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment">//获取元素在兄弟元素中的排行</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
    <span class="token keyword">var</span> p <span class="token operator">=</span> index <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">200</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#images'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                         <span class="token comment">//移动图片</span>
        transform<span class="token punctuation">:</span> <span class="token string">'translate('</span> <span class="token operator">+</span> p <span class="token operator">+</span> <span class="token string">'px)'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    n <span class="token operator">=</span> index
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>如代码所示，首先先通过jQuery获取到所有的按钮标签，然后给所有按钮都添加点击事件，再由每个元素在兄弟元素总的排行来确定轮播时图片需要移动多少的距离才能移动到目标图片。</p> <h3 id="过渡动画"><a href="#过渡动画" aria-hidden="true" class="header-anchor">#</a> 过渡动画</h3> <p>在要将改变的元素加上过渡效果可以显示出过渡的动画，所以这里给包裹图片的盒子加上：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.images</span><span class="token punctuation">{</span>
    <span class="token property">transition</span><span class="token punctuation">:</span>transform 0.5s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这里顺便提一句，如果一直图片宽高，最好把宽高设定这样式里，这样就可以在页面加载前就先把页面上图片的页面确定下来，避免了页面加载过程中可能发生的重排过程。</p> <h3 id="自动播放"><a href="#自动播放" aria-hidden="true" class="header-anchor">#</a> 自动播放</h3> <p>通过自动执行函数来实现自动实现图片轮播的功能。下面是实现的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">var</span> size <span class="token operator">=</span> buttons<span class="token punctuation">.</span>length
buttons<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>n <span class="token operator">%</span> size<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>                <span class="token comment">//设置初始状态</span>
<span class="token keyword">var</span> timeId <span class="token operator">=</span> <span class="token function">setTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">setTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>                             <span class="token comment">//每1000ms自行一次触发事件</span>
        n<span class="token operator">++</span>
        buttons<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>n <span class="token operator">%</span> size<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>正如代码所示，首先设置第一个按钮最初为触发状态，即此时展示第一张图片。然后每隔1.5s就轮流执行每隔按键的点击事件，因为之前已经设定好了每次在点击按钮是就会切换图片，所以这样就实现了图片的自动轮播的效果。</p> <h3 id="鼠标浮动控制轮播"><a href="#鼠标浮动控制轮播" aria-hidden="true" class="header-anchor">#</a> 鼠标浮动控制轮播</h3> <p>这里就比较简单了，只需要在包裹图片的盒子上添加一个鼠标进入、一个鼠标移出的监听事件，在监听事件中分别设置删除定时器与添加定时器的内容即可：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.window'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseenter'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>timeId<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.window'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseleave'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    timeId <span class="token operator">=</span> <span class="token function">setTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这里需要指出的是，在鼠标点击事件中设置了n=index，这样即便定时器被删除，n=index仍然记录了当前轮播的图片的位置，这样在鼠标移出图片重新开始轮播时，仍然可以从当前图片继续轮播。</p> <hr> <p>以上就是的jQuery的整体实现思路，通过这个思路可以很容易的完成一个简单的轮播效果。可以明显地看出，缺陷是比较明显的，有的时候点击按钮图片会切换的很不自然，而且在切出网页再回来时，动画会有一小段时间的混乱。</p> <div style="text-align:center;"><iframe src="http://franko.top/swiper/swiper.html" width="270px" height="270px"></iframe></div> <h2 id="无缝轮播"><a href="#无缝轮播" aria-hidden="true" class="header-anchor">#</a> 无缝轮播</h2> <p>这次的目的就是要做出一个无缝的轮播。什么是无缝轮播？就是从最后一张直接顺序地切换到第一张图片。在之前的轮播效果里，从第四张图片切至第一张时是有一个回滚的过程的，这回不能这样回滚了。所以之前的思路在这次是要推翻的，现在就来讲讲无缝轮播的大致思路。</p> <h3 id="图片的初始状态"><a href="#图片的初始状态" aria-hidden="true" class="header-anchor">#</a> 图片的初始状态</h3> <p>不能像原来那样讲图片一字排开，再水平移动图片那样展示了。要想实现无缝轮播，大概要这样想，首先展示一张图片，其他图片都堆在一起；然后展示第二张图片，就把第一张抽回堆中，把第二张展示出去，这样依次展示下去，最后一张与第一张的切换就没有明显的不同了。</p> <p>要做到这样的效果，所有的图片就都绝对定位于相框的右侧，这样每当图片展示时，图片就单独往左移动，展示完毕的图片先执行一个图片向左移出的动画，再移动回相框的右侧。所以可以把轮播的图片分为三种状态：进入、展示、离开。这三种状态分别写三个类来设定它的水平移动位置：</p> <div class="language-cs line-numbers-mode"><pre class="language-text"><code>.images &gt; img{
    position: absolute;
    top:0;
    transition: all 1s;
}
.images &gt; img.current{
    transform: translateX(0);
    z-index:1;
}
.images &gt; img.enter{
    transform: translateX(200px);
}
.images &gt; img.leave{
    transform: translateX(-200px);
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>这样，整个轮播过程就可以有一个大概地雏形了，每次移动都用1s来完成。并且展示中的图片设置为z-index:1，会默认盖在移动中的图片上方，这样就能平滑地显示轮播效果了。</p> <h3 id="自动播放-2"><a href="#自动播放-2" aria-hidden="true" class="header-anchor">#</a> 自动播放</h3> <p>这次通过监听动画结束的方法来实现图片的自动播放，每当上一张图片完成移动的动画结束后，下一张图片就开始移动，这样就可以实现动画的永续进行：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">setTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> n <span class="token operator">=</span> index <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token function">makeLeave</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">one</span><span class="token punctuation">(</span><span class="token string">'transitionend'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//展示的图片移出</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">'leave'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment">//在监听对象具有leave类时才会执行添加enter类</span>
                <span class="token function">makeEnter</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>    <span class="token comment">//移出的图片移至待定区</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token function">makeCurrent</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>      <span class="token comment">//待定区的图片展示</span>
        index<span class="token operator">++</span>             <span class="token comment">//展示下一张图片</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>                <span class="token comment">//2秒执行一次</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>需要指出的是，在这个定时器中的动画监听事件（one）是一次性的，即只监听当一张正式完成后的图片移动到相框左侧这段动画的结束（即makeLeave函数执行完毕），这段动画结束之后就会给监听的图片添加enter类（即代码中的makeEnter函数），图片就会移动到相框右侧进行等待。如果这个这个监听事件不是一次性的（on）那么每当任何动画结束，都会给被监听的图片添加enter类，这样动画就混乱了。</p> <p>这三个状态切换函数大致如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">makeLeave</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token comment">//移出状态</span>
    <span class="token function">$</span><span class="token punctuation">(</span>\`#buttons <span class="token operator">&gt;</span> button<span class="token punctuation">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token punctuation">)</span>\`<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span>\`<span class="token punctuation">.</span>images <span class="token operator">&gt;</span> img<span class="token punctuation">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token punctuation">)</span>\`<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'current enter'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'leave'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">makeEnter</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token comment">//待定状态</span>
    <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'leave current'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'enter'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">makeCurrent</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//展示状态</span>
    <span class="token function">$</span><span class="token punctuation">(</span>\`#buttons <span class="token operator">&gt;</span> button<span class="token punctuation">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>n <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\`<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span>\`<span class="token punctuation">.</span>images <span class="token operator">&gt;</span> img<span class="token punctuation">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>n <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\`<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'enter leave'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'current'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>通过jQuery对象对这三个函数的调用就可以完成图片的三种状态的切换了。</p> <h3 id="按钮优化"><a href="#按钮优化" aria-hidden="true" class="header-anchor">#</a> 按钮优化</h3> <p>上面大致就完成了一个自动的无缝轮播的效果，我自己在此基础上也加了一些优化，当然后面方方老师也讲了一些继续优化的方法，这里都讲一下。</p> <p>首先是给轮播加个按键切换图片的功能，这一点倒是让我想了好久。我是这样想的，按下按键后切换到指定图片，然后关闭计时器，重新初始化；再过1s后再开启计时器继续轮播。因为在切换图片的这个过程仍会显示动画，我就试着在按下按钮后给所有图片添加一个stop类，停止动画的显示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>buttons<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>        <span class="token comment">//按钮事件</span>
    window<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>timeId<span class="token punctuation">)</span>    <span class="token comment">//按下后停止轮播</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.images &gt; img'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'stop'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'leave current'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'enter'</span><span class="token punctuation">)</span>  <span class="token comment">//重新初始化</span>
    index <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>currentTarget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">init</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>          <span class="token comment">//继续轮播</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.images &gt; img'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'stop'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    timeId <span class="token operator">=</span> <span class="token function">setTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>重新开始轮播之后给图片再删除stop类，这样动画又会继续显示了。这个过程我想了比较久，问题在于这个stop类不能直接放在监听事件中，必须要再包一层计时器，这个方法也是我随便试出来的。第二天我在课上就听到方方老师讲到这个内容，明天的博客就写这个了。</p> <h3 id="切换页面的bug"><a href="#切换页面的bug" aria-hidden="true" class="header-anchor">#</a> 切换页面的BUG</h3> <p>除此之外，还有刚才提到的切换页面导致动画错乱的bug，这是由于在切换页面后，浏览器为了节省空间，它会把所有切除页面这段时间的动画堆积到切回页面时一次性执行。这个问题我发现了，但是不知道怎么解决。在课上，方方老师给出了监听页面切换的方法：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'visibilitychange'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>hidden<span class="token punctuation">)</span><span class="token punctuation">{</span>
        window<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>timeId<span class="token punctuation">)</span> 
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        timeId <span class="token operator">=</span> <span class="token function">setTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这样，在页面切换时，计时器也会被删除，轮播暂停；在页面切换回来时，再重新设置计时器，继续轮播。下面就是我这次做出来的无缝轮播效果，可能还有一些bug，但是已经不是很明显了：</p> <div style="text-align:center;"><iframe src="http://franko.top/swiper/seamless.html" width="270px" height="270px"></iframe></div> <hr> <p>除此之外，方方老师还提供了优化方法。可以继续用第一个轮播的思路，这个时候就要使用偷梁换柱的方法：在第一个图片左边克隆最后一张图片；在最后一张图片右边克隆一张第一张图片。这样就可以像做第一种轮播一样，修改图片的水平位置即可，在最后一张切换到第一张时，就可以先切到克隆的第一张。再从克隆的第一张切至真的第一张。</p> <p>为了让“由假到真”这个过程不显示出动画来，达到欺骗用户的效果，需要这样设置：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$slide<span class="token punctuation">.</span>hide<span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
$slide<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    transform<span class="token punctuation">:</span><span class="token string">'translateX(-400px)'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>就是在图片移动时将这个图片隐藏起来。为了让show与hide这两个操作不产生合并，则需要则hide后面添加一个offset操作。offset()可以输出元素的坐标，因为offset计算时必须将整个代码执行的过程暂停。如果不加上offset()，hide与show会被认为是同步执行的，就会因为合并而抵消。</p><div style="text-align:center;"><img src="20181106A/001.jpg" alt="迷茫"></div><p></p> <p>上面大概就是我上周整个无缝轮播学习的整个过程，虽然记录这些东西不见得对我有多大帮助，但是还是让我有了一些安稳的感觉吧。这次博客也花了两个钟，这是我没想到的。</p></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">1/19/2020, 2:08:27 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/1811/20181105A.html" class="prev">
          【整理】DOM API
        </a></span> <span class="next"><a href="/1811/20181109A.html">
          【归纳】DOM事件模型
        </a>
        →
      </span></p></div> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.20586f85.js" defer></script><script src="/assets/js/3.a975d71c.js" defer></script><script src="/assets/js/1.f9715dde.js" defer></script><script src="/assets/js/39.0a74782b.js" defer></script>
  </body>
</html>
