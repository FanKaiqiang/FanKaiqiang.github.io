<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【记录】JS模拟继承 | Franko&#39;s Blog</title>
    <meta name="description" content="长江一帆远，落日五湖春。">
    <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.82618647.css" as="style"><link rel="preload" href="/assets/js/app.20586f85.js" as="script"><link rel="preload" href="/assets/js/3.a975d71c.js" as="script"><link rel="preload" href="/assets/js/1.f9715dde.js" as="script"><link rel="preload" href="/assets/js/55.7b929339.js" as="script"><link rel="prefetch" href="/assets/js/10.3713fa2b.js"><link rel="prefetch" href="/assets/js/100.c7e8673f.js"><link rel="prefetch" href="/assets/js/101.29a59833.js"><link rel="prefetch" href="/assets/js/102.3fbd0f95.js"><link rel="prefetch" href="/assets/js/103.72c6e9b5.js"><link rel="prefetch" href="/assets/js/104.f6f27012.js"><link rel="prefetch" href="/assets/js/105.0d66958f.js"><link rel="prefetch" href="/assets/js/106.290db28e.js"><link rel="prefetch" href="/assets/js/107.e20e3803.js"><link rel="prefetch" href="/assets/js/108.cd45cee0.js"><link rel="prefetch" href="/assets/js/109.4ba3d58f.js"><link rel="prefetch" href="/assets/js/11.3f5de7ee.js"><link rel="prefetch" href="/assets/js/110.0d55c579.js"><link rel="prefetch" href="/assets/js/111.3648d92a.js"><link rel="prefetch" href="/assets/js/112.cf39ecb8.js"><link rel="prefetch" href="/assets/js/113.6f2fdbc4.js"><link rel="prefetch" href="/assets/js/114.77c92b08.js"><link rel="prefetch" href="/assets/js/115.0656b5e6.js"><link rel="prefetch" href="/assets/js/116.80cf31f3.js"><link rel="prefetch" href="/assets/js/117.2b92a260.js"><link rel="prefetch" href="/assets/js/118.c06968f3.js"><link rel="prefetch" href="/assets/js/119.20ab4e08.js"><link rel="prefetch" href="/assets/js/12.19e53560.js"><link rel="prefetch" href="/assets/js/120.97d79ae7.js"><link rel="prefetch" href="/assets/js/121.f6da62ca.js"><link rel="prefetch" href="/assets/js/122.859caf01.js"><link rel="prefetch" href="/assets/js/13.dda8f215.js"><link rel="prefetch" href="/assets/js/14.2a592289.js"><link rel="prefetch" href="/assets/js/15.4925e3a4.js"><link rel="prefetch" href="/assets/js/16.0f840892.js"><link rel="prefetch" href="/assets/js/17.3e801416.js"><link rel="prefetch" href="/assets/js/18.b4d3a92e.js"><link rel="prefetch" href="/assets/js/19.f9cee7a0.js"><link rel="prefetch" href="/assets/js/20.3f33780e.js"><link rel="prefetch" href="/assets/js/21.ed566f24.js"><link rel="prefetch" href="/assets/js/22.94f8e887.js"><link rel="prefetch" href="/assets/js/23.fb38ed6e.js"><link rel="prefetch" href="/assets/js/24.dd36a8c2.js"><link rel="prefetch" href="/assets/js/25.bb6cacf5.js"><link rel="prefetch" href="/assets/js/26.c86a26fa.js"><link rel="prefetch" href="/assets/js/27.2dd1516a.js"><link rel="prefetch" href="/assets/js/28.83a01027.js"><link rel="prefetch" href="/assets/js/29.fcd25cd4.js"><link rel="prefetch" href="/assets/js/30.a1c1c82d.js"><link rel="prefetch" href="/assets/js/31.274c9b5e.js"><link rel="prefetch" href="/assets/js/32.f75d4ae9.js"><link rel="prefetch" href="/assets/js/33.1e4d92da.js"><link rel="prefetch" href="/assets/js/34.4ef7ac99.js"><link rel="prefetch" href="/assets/js/35.4f47ea1f.js"><link rel="prefetch" href="/assets/js/36.f1911a7c.js"><link rel="prefetch" href="/assets/js/37.b562ea4c.js"><link rel="prefetch" href="/assets/js/38.b862a71d.js"><link rel="prefetch" href="/assets/js/39.0a74782b.js"><link rel="prefetch" href="/assets/js/4.46f5c0e2.js"><link rel="prefetch" href="/assets/js/40.f75bdd02.js"><link rel="prefetch" href="/assets/js/41.62a05ca3.js"><link rel="prefetch" href="/assets/js/42.1a733cf6.js"><link rel="prefetch" href="/assets/js/43.7506e026.js"><link rel="prefetch" href="/assets/js/44.568d2265.js"><link rel="prefetch" href="/assets/js/45.50e5cd0c.js"><link rel="prefetch" href="/assets/js/46.2c3c32c9.js"><link rel="prefetch" href="/assets/js/47.f9a54e6b.js"><link rel="prefetch" href="/assets/js/48.32da44eb.js"><link rel="prefetch" href="/assets/js/49.df6b0b62.js"><link rel="prefetch" href="/assets/js/5.bb6aabf2.js"><link rel="prefetch" href="/assets/js/50.52d40ed6.js"><link rel="prefetch" href="/assets/js/51.e7a7badb.js"><link rel="prefetch" href="/assets/js/52.6a20c4e8.js"><link rel="prefetch" href="/assets/js/53.2747af5b.js"><link rel="prefetch" href="/assets/js/54.02396d0d.js"><link rel="prefetch" href="/assets/js/56.f24df74e.js"><link rel="prefetch" href="/assets/js/57.a39d5e97.js"><link rel="prefetch" href="/assets/js/58.b13862f5.js"><link rel="prefetch" href="/assets/js/59.b2ef3cb1.js"><link rel="prefetch" href="/assets/js/6.9a323443.js"><link rel="prefetch" href="/assets/js/60.3b294663.js"><link rel="prefetch" href="/assets/js/61.23d3575f.js"><link rel="prefetch" href="/assets/js/62.9c1cd3c8.js"><link rel="prefetch" href="/assets/js/63.4376c00d.js"><link rel="prefetch" href="/assets/js/64.59741dd5.js"><link rel="prefetch" href="/assets/js/65.8e59eee4.js"><link rel="prefetch" href="/assets/js/66.a07156ca.js"><link rel="prefetch" href="/assets/js/67.bad8de6a.js"><link rel="prefetch" href="/assets/js/68.348f3c6f.js"><link rel="prefetch" href="/assets/js/69.27403668.js"><link rel="prefetch" href="/assets/js/7.7376f609.js"><link rel="prefetch" href="/assets/js/70.e105d08d.js"><link rel="prefetch" href="/assets/js/71.3912c588.js"><link rel="prefetch" href="/assets/js/72.2e803182.js"><link rel="prefetch" href="/assets/js/73.698bb062.js"><link rel="prefetch" href="/assets/js/74.6eb02d59.js"><link rel="prefetch" href="/assets/js/75.5e85377b.js"><link rel="prefetch" href="/assets/js/76.a50ad35f.js"><link rel="prefetch" href="/assets/js/77.9923eba2.js"><link rel="prefetch" href="/assets/js/78.30d80868.js"><link rel="prefetch" href="/assets/js/79.b0633c2f.js"><link rel="prefetch" href="/assets/js/8.effb8ee5.js"><link rel="prefetch" href="/assets/js/80.1c7129b4.js"><link rel="prefetch" href="/assets/js/81.757e25f5.js"><link rel="prefetch" href="/assets/js/82.04a6c134.js"><link rel="prefetch" href="/assets/js/83.a5425512.js"><link rel="prefetch" href="/assets/js/84.478c64ab.js"><link rel="prefetch" href="/assets/js/85.e304024e.js"><link rel="prefetch" href="/assets/js/86.46d38efd.js"><link rel="prefetch" href="/assets/js/87.8ab01c2a.js"><link rel="prefetch" href="/assets/js/88.695a06d9.js"><link rel="prefetch" href="/assets/js/89.2b9afe77.js"><link rel="prefetch" href="/assets/js/9.a3297750.js"><link rel="prefetch" href="/assets/js/90.6dd7f214.js"><link rel="prefetch" href="/assets/js/91.891f6634.js"><link rel="prefetch" href="/assets/js/92.32bd7ffa.js"><link rel="prefetch" href="/assets/js/93.646030b0.js"><link rel="prefetch" href="/assets/js/94.2df43ae3.js"><link rel="prefetch" href="/assets/js/95.ca4e89a0.js"><link rel="prefetch" href="/assets/js/96.4b4fcf2a.js"><link rel="prefetch" href="/assets/js/97.705f40c5.js"><link rel="prefetch" href="/assets/js/98.3035542d.js"><link rel="prefetch" href="/assets/js/99.40877126.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82618647.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Franko's Blog</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/笔记.html" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/category/随笔.html" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/category/项目总结.html" class="nav-link"><i class="iconfont undefined"></i>
  项目总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读书记录.html" class="nav-link"><i class="iconfont undefined"></i>
  读书记录
</a></li><li class="dropdown-item"><!----> <a href="/category/翻译.html" class="nav-link"><i class="iconfont undefined"></i>
  翻译
</a></li><li class="dropdown-item"><!----> <a href="/category/关于我.html" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/笔记.html" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/category/随笔.html" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/category/项目总结.html" class="nav-link"><i class="iconfont undefined"></i>
  项目总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读书记录.html" class="nav-link"><i class="iconfont undefined"></i>
  读书记录
</a></li><li class="dropdown-item"><!----> <a href="/category/翻译.html" class="nav-link"><i class="iconfont undefined"></i>
  翻译
</a></li><li class="dropdown-item"><!----> <a href="/category/关于我.html" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>2020</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>九月</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2009/20200919A.html" class="sidebar-link">【归纳】代码优化技巧与可读性</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>五月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>四月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>三月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>二月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>一月</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2019</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2018</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>【记录】JS模拟继承</h1> <hr> <div data-v-b53d65a4><i class="iconfont reco-account" data-v-b53d65a4><span data-v-b53d65a4>广宇</span></i> <i class="iconfont reco-date" data-v-b53d65a4><span data-v-b53d65a4>2018-11-30</span></i> <!----> <i class="iconfont reco-tag tags" data-v-b53d65a4><span class="tag-item" data-v-b53d65a4>
      JavaScript
    </span></i></div></div> <div class="content__default"><div class="tip custom-block"><p>今天继续学习剩下的课程。系统课已经基本学完，剩下的几节课是属于查漏补缺的课程。其中有一个比较重要的知识点被反复提到，就是JS的原型与继承。</p></div> <p>本篇博客同样也是课后任务的一部分，这些内容是被当作「一些重要但前面没讲的内容」来讲的，值得重视。</p><div style="text-align:center;"><img src="20181129A/timg.jfif" alt="重要内容"></div><p></p> <p>之前这个知识点也被作为JS的押题项被提出来过，当时还在想要不要写，毕竟早在一个多月前学习JS中的原型的时候好像就写了一篇关于<a href="http://franko.top/1810/20181017A/" target="_blank" rel="noopener noreferrer">【记录】原型与原型链<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的博客作为课后任务。那个时候对于这块知识还是处于开荒的状态，写完博客之后还是对自己的掌握程度不够满意。当时还有些挫败感。</p> <p>一个月之后我的系统课也基本学完了，现在回头看这些感觉也并没有多难，而且在今天听了关于继承的内容之后，感觉对这方面的知识掌握程度也有一定程度的加深。所以这次就借着这节课的课后任务的机会，把有关JS的继承这方面的知识写一下。主要就是把上课的笔记过一遍吧，这次记得笔记有点多，顺便查查资料，把知识拓展一下。</p> <h2 id="js中的继承"><a href="#js中的继承" aria-hidden="true" class="header-anchor">#</a> JS中的继承</h2> <h3 id="什么是继承"><a href="#什么是继承" aria-hidden="true" class="header-anchor">#</a> 什么是继承</h3> <p>直接看维基百科，维基百科里面关于继承是这样说的：</p> <blockquote><p>继承（英语：inheritance）是面向对象软件技术当中的一个概念。如果一个类别B“继承自”另一个类别A，就把这个B称为“A的子类”，而把A称为“B的父类别”也可以称“A是B的超类”。<strong>继承可以使得子类具有父类别的各种属性和方法</strong>，而不需要再次编写相同的代码。</p></blockquote> <p>上面这段话说得很清楚，基本上把我接下来要说的都大致地提到了一下，现在就把它展开来讲讲。</p> <p>首先继承是面向对象编程中的一个概念。面向对象编程有一套完整的术语，比如类、实例、方法、继承、接口、多态、反射等等。看到继承与多态，就让我想起了大三的时候学Java的时候就是学过的，现在也忘得差不多了，当年没有认真学，不然现在也不会选择走前端这条路，想来也是感慨万千。</p> <p>可是没想到JavaScript的继承与Java的继承相差如此之大。前面高亮了一句话，继承可以使得子类具有父类别的各种属性和方法，他说得一点都没错，但是在ES6之前，JavaScript里并没有类，连类都没有那又谈何继承呢。这就要引入今天的主题，原型继承了。</p> <h3 id="原型继承"><a href="#原型继承" aria-hidden="true" class="header-anchor">#</a> 原型继承</h3> <p>关于原型继承，MDN中这样介绍：</p> <blockquote><p>当谈到继承时，JavaScript 只有一种结构：对象。每个实例对象（object ）都有一个私有属性（称之为<code>__proto__</code>）指向它的原型对象（prototype）。该原型对象也有一个自己的原型对象(<code>__proto__</code>) ，层层向上直到一个对象的原型对象为 null。根据定义，null 没有原型，并作为这个原型链中的最后一个环节。</p></blockquote> <p>举个例子，最开始学习的全局对象window里面有许多方法，比如Object()、Array()、Function()等等。这些方法一般称之为构造函数。以这三个构造函数都有一个重要属性———原型。比如<code>Object.prototype</code>就是Object函数的原型，这个属性也是一个对象。</p> <p>假设声明一个变量a，令<code>a = new Object()</code>，这样a就是一个新生成的空对象。既然是空对象，那么a.toString()这个方法是从何而来的呢？在之前的博客就讲过了，对象a中具有一个指向它的原型对象（prototype）的私有属性（<code>__proto__</code>）。toString方法是存在于Object的原型对象里的，借助这个<code>__proto__</code>属性，a对象与toString方法产生了关联。那么这种行为可以被称为继承吗？</p> <p>事实上，无论是在刚才引用的维基百科也好，MDN也罢，都没有就继承给出一个明确的定义，只说了继承是面向对象编程的一个概念。继承是类与类的关系，但是在JavaScript中并没有类，虽然在ES6 中引入了class关键字，但也只是语法糖，JavaScript 仍然是基于原型的。所以要假设刚才提到的这些构造函数是类，这也是为什么的这篇博客题目也是「JS模拟继承」，不是真正真正的继承，是在模拟继承的效果。</p><div style="text-align:center;"><img src="20181129A/001.jfif" alt="继承"></div><p></p> <p>在JS中什么叫做继承？继承需要两个类，子类与父类。假设Object是类、Array也是类，这两个对象本身之间并没有关系。但是因为几乎所有 JavaScript 中的对象都是位于原型链顶端的Object的实例，其中也包括Array.prototype，因此具有<code>Array.prototype.__proto__ = Object.prototype</code>这样一条关系。所以Array构造出来的对象直接拥有Object对象的属性，因此可以把Array看作是Object的子类。</p> <p>再声明一个变量b，<code>b = new Array()</code>。b就是新建的一个数组对象，知道，数组对象具有push()方法，也具有valueof()方法。a的push()方法是从它的原型<code>a.__proto__ = Array.prototype</code>上获取的，但是a的原型上并没有valueof()方法，所以就要去a的原型的原型（即Object.prototype）上找，总共进行了两次搜索。</p> <p>在这个例子里a的valueof()方法通过两次搜索才获得，可以称之为是继承只Object的。而a的push()方法则是a的实例属性，并不能称之为继承得来的。与之相似地，CSS中也有样式继承的概念，比如一个<code>&lt;div&gt;</code>中包着一个<code>&lt;span&gt;</code>，如果<code>&lt;span&gt;</code>自己设定了font-size，就不能称之为继承样式，如果<code>&lt;span&gt;</code>没有设定font-size，则会继承<code>&lt;div&gt;</code>的font-size。</p> <p>这里顺便举一个特例，Array的原型与Object的原型中都有一个toString方法。与CSS的继承规则相似，这个时候在子类别在继承父类别的同时，还可以重新定义某些属性，并重写某些方法，即覆盖父类别的原有属性和方法，使其获得与父类别不同的功能。所以a的toString方法是a的实例属性，是经过重写的，与Object的toString不同。</p> <p>讲了这么多，回到一点，就是一直是在假设上面这些构造函数是类，也只是在「模拟」继承的效果。但是在面试官在面试的时候不会管这么多，他认为JS可以有继承。可能会被要求自己使用JS实现一下继承的效果。当然照着上面这些构造函数写是不行的，这些是已经存在的，不是自己实现的。要自己实现继承效果，那么问题来了，在JS中怎么写出一个类呢？</p> <h2 id="es5中实现继承"><a href="#es5中实现继承" aria-hidden="true" class="header-anchor">#</a> ES5中实现继承</h2> <p>在ES5中没有类，如何实现一个类呢，那什么又是类呢？继承没有定义，类总有定义，这回看看百度百科上怎么讲：</p> <blockquote><p>类（Class）是面向对象程序设计（OOP，Object-Oriented Programming）实现信息封装的基础。类是一种用户定义类型，也称类类型。每个类包含数据说明和一组操作数据或传递消息的函数。类的实例称为对象。</p></blockquote> <p>意思就是能产生对象的东西即为类。话不多说，直接上代码，然后再来一句句进行讲解：</p> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">function</span> <span class="token function">Human</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">//这个函数自身的属性</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
 <span class="token punctuation">}</span>
 <span class="token class-name">Human</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">//原型上的属性</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我叫&quot;</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">&quot;，我在跑&quot;</span><span class="token punctuation">)</span>
     <span class="token keyword">return</span> <span class="token keyword">undefined</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">function</span> <span class="token function">Man</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token function">Human</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token comment">//调用父类，继承父类本身的属性</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">'男'</span>
 <span class="token punctuation">}</span>

<span class="token comment">// 这样的写法是错误的</span>
<span class="token comment">// Man.prototype.__proto__ = Human.prototype</span>
<span class="token comment">// 下面的三行代码连接了父类与之类的原型</span>
 <span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 f<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">Human</span><span class="token punctuation">.</span>prototype
 <span class="token class-name">Man</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 <span class="token class-name">Man</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fight</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'糊你熊脸'</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Man</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>在上面实现了一个类Man，Man的父类Human，Human的父类就是Object了。在构造函数中定义类的自身属性，在原型中构造类的共有属性。通过在Man中调用Human，就可以让Man继承Human的自身属性。那如何把Human原型上的属性也让Man继承呢？</p> <p>的目的就是实现<code>Man.prototype.__proto__ = Human.prototype</code>的效果，但是在</p> <p>在JS中，这些构造函数都有一个重要属性prototype，它们之间通过prototype互相关联，最后实现继承。为什么prototype这个重要属性，有些函数有，有些函数没有呢？原因就在于，这些函数是构造函数，只有构造函数具有prototype属性。<strong>prototype属性有且只有存放共有属性的地址的功能</strong>。至于<code>__proto__</code>属性则是每个对象都有的属性，它指向该对象的构造函数存放共有属性的地址。</p> <p>所以，的目的就是实现<code>Man.prototype.__proto__ = Human.prototype</code>的效果，但是在IE中是不支持直接给原型链赋值的，而且这样做对性能的消耗也是比较大的，因为在原型链上查找属性比较耗时，如果访问不存在的属性时会遍历整个原型链。所以不推荐直接对<code>__proto__</code>属性进行修改。所以才要用到上面例子的那三行代码：</p> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 f<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">Human</span><span class="token punctuation">.</span>prototype
 <span class="token class-name">Man</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这三行代码与<code>Man.prototype.__proto__ = Human.prototype</code>等价。声明一个空函数，然后让这个函数的prototype属性指向Human.prototype。那么在<code>Man.prototype = new f()</code>这一句中发生了什么事情，当使用new时，会发生什么？以上面代码中的new为例，来分析一下：</p> <ol><li>首先new关键字会产生一个空对象temp</li> <li>在这个空对象中，令this等于temp</li> <li>令this的<code>__proto__</code>属性等于构造函数f()的prototype（原型对象）</li> <li>在temp中调用一遍f()</li> <li>把this的结果return，即将这个temp赋值给Man.prototype</li></ol> <p>通过上面的操作，虽然不能直接操作<code>__proto__</code>属性，但是通过new实现了间接操作<code>__proto__</code>属性。相当于令<code>Man.prototype === temp</code> ，再令<code>temp.__proto__ === Human.prototype</code>。从而实现了<code>Man.prototype.__proto__ = Human.prototype</code>的效果。</p> <p>那么为什么不直接写<code>Man.prototype = new Human()</code>，因为既然空函数f的prototype就是Human的prototype，为什么还要用到这个空函数f呢？事实上不使用这个f的写法确实也可以达到将Man与Human的原型连接起来的效果，但是也产生了一个副作用，问题就在于上面分析的第四步。它会在Man.prototype里调用一次Human，使得Man.prototype中含有Human的自有属性。换句话说，这样就相当于把Man.prototype作为Human的一个实例了，事实显然不是如此。所以使用一个空函数进行过渡是必要的，调用一个空函数就不会产生这些影响。</p> <h2 id="es6中实现继承"><a href="#es6中实现继承" aria-hidden="true" class="header-anchor">#</a> ES6中实现继承</h2> <p>ES6中引入了class关键字，使得可以正式地去声明一个类。不过使用class声明的类使用typeof返回的数据类型仍然是function，所以说class是一个帮助更好在JS中实现类的一个语法糖，而不是真正地创建一个类。</p><div style="text-align:center;"><img src="20181129A/002.jfif" alt="ES6"></div><p></p> <p>既然是语法糖，那么使用class实现继承肯定要比ES5的土办法要方便得多，直接来看代码：</p> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">class</span> <span class="token class-name">Human</span><span class="token punctuation">{</span>
     <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//自身属性写在constructor里</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
     <span class="token punctuation">}</span>
     <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//原型中的共有属性与constructor并列写出</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我叫&quot;</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">&quot;，我在跑&quot;</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span> <span class="token keyword">undefined</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">class</span> <span class="token class-name">Man</span> <span class="token keyword">extends</span> <span class="token class-name">Human</span><span class="token punctuation">{</span>   <span class="token comment">//使用extends关键字实现共有属性继承</span>
     <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>    <span class="token comment">//使用super关键字调用父类构造函数</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">'男'</span>
     <span class="token punctuation">}</span>
     <span class="token function">fight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'糊你熊脸'</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>上面就是ES6的写法，无论是代码的整洁性还是复杂度，对比ES5的写法都得到了提高。一个类的自有属性与共有属性全部都在类定义中写出，而且类的共有属性的继承直接用一个extends关键字就解决了，在ES5罗嗦了那么久。其中super意为超类（父类），这句代码等同于<code>Human.call(this, name)</code>，即调用父类构造函数。可能是为了让这些构造函数更像是一个类，所以才推出了这种写法吧。</p> <p>可以看出这种方法非常方便，大多数人在了解这两种方法之后肯定也会毫不犹豫选择使用前者，毕竟是语法糖嘛。但是ES6的这种方法也是有缺陷的。这种方法只能在原型上声明函数属性，如果要在原型上声明非函数属性怎么办？其实也有转寰的办法，大概是这样做：</p> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">class</span> <span class="token class-name">Human</span><span class="token punctuation">{</span>
     <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
     <span class="token punctuation">}</span>
     <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我叫&quot;</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">&quot;，我在跑&quot;</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span> <span class="token keyword">undefined</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">get</span> <span class="token function">s</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment">//相当于ES5中的 Human.prototype = '人类'</span>
         <span class="token keyword">return</span> <span class="token string">'人类'</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>就是把原本的非函数属性的内容作为一个函数的返回值，再通过get语法把这个将这个返回值绑定到Human类上作为属性。但是这样一来，如果是不明白其中原理的人绝对会一头雾水、不知所云。ES5的代码虽然看起来更为繁杂，但是逻辑性更好，阅读完代码之后就知道它要做什么，而且ES5的声明原型属性也更为灵活，可以一条一条声明，不必一次性在class声明时一次性写完。所以ES5的方法与class语法糖相比，除了代码量得到了一定的减少，并没有过多的劣势。</p> <hr> <p>完成于 2018年11月30日 11:26:19</p> <p>上面就是本篇博客中关于JS模拟继承的内容。这次写了这么久，也是我没有预料到的。大部分内容其实是我已经写在笔记里的，参考了一些MDN里的内容：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain" target="_blank" rel="noopener noreferrer">继承与原型链 - JavaScript | MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>可能是我的笔记记得过多了吧，把这些笔记整理成文章的思路花费了一些时间。不过总算是完成了，这也只是半节课的内容。看来今天正式完结系统课还是有难度，不仅如此，今天份的博客恐怕也要拖到明天才能写完了。</p><div style="text-align:center;"><img src="20181129A/003.jfif" alt="终点"></div><p></p></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">1/19/2020, 2:08:27 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/1811/20181128A.html" class="prev">
          【总结】仿网易云音乐项目
        </a></span> <span class="next"><a href="/1811/20181130A.html">
          【归纳】HTTP缓存相关知识
        </a>
        →
      </span></p></div> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.20586f85.js" defer></script><script src="/assets/js/3.a975d71c.js" defer></script><script src="/assets/js/1.f9715dde.js" defer></script><script src="/assets/js/55.7b929339.js" defer></script>
  </body>
</html>
