(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{427:function(t,s,e){"use strict";e.r(s);var a=e(40),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("div",{staticClass:"tip custom-block"},[e("p",[t._v("今天是五月最后一天了，周六休息了一天感觉神清气爽。虽然其实休息也没怎么休息就是了，午睡也没有睡，因为准备租房了还去和总结看来两套房。但是只要没有在上班就感觉很爽。趁现在还有空就把还是之前翻译的一篇 Mobx 升级相关的文章搬运过来，充实一下这个月的博客数量吧。")])]),t._v(" "),e("p",[t._v("这篇文章是 Mobx 作者写的一篇关于 Mobx 3 升级到 Mobx 4 的迁移指南。")]),e("div",{staticStyle:{"text-align":"center"}},[e("img",{attrs:{src:"https://s1.ax1x.com/2020/05/31/t1kWMF.jpg",alt:"封面"}})]),e("p"),t._v(" "),e("blockquote",[e("p",[t._v("翻译原文："),e("a",{attrs:{href:"https://github.com/mobxjs/mobx/wiki/Migrating-from-mobx-3-to-mobx-4",target:"_blank",rel:"noopener noreferrer"}},[t._v("Migrating from mobx 3 to mobx 4 · mobxjs/mobx Wiki"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"变更概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#变更概述","aria-hidden":"true"}},[t._v("#")]),t._v(" 变更概述")]),t._v(" "),e("p",[t._v("非常抱歉，本迁移指南看起来如此的又大又长 😃，不过好消息是，可能您从未听说过本指南中提到的大多数变更。但是作为指南是需要无懈可击的，需要将它们全部列出。MobX 4 将会在运行时检测到大部分错误的/已弃用的 api 的使用情况，因此迁移的最简单的方法就是先升级，再根据本指南修复错误。如果您在项目中启用了TypeScript（或Flow），那么在编译时就会标记出来大多数不赞成使用的 api。")]),t._v(" "),e("p",[t._v("MobX 4 删除了早在 MobX 3 中就已经弃用了的所有 api。因此，请确保在升级之前没有任何弃用警告: )。")]),t._v(" "),e("p",[e("code",[t._v("extras")]),t._v("命名空间被删除了，其中包含的所有的方法现在都在包顶层公开出来。这样可以使得 rollup 或 Webpack 等工具可以更好地进行 tree-shaking。")]),t._v(" "),e("p",[t._v("MobX 4 针对生产环境与开发环境推出了单独的版本。在生产环境中将取消大多数类型检查，以生成运行更快，体积更小的版本。因此请确保在您的构建过程中不做"),e("code",[t._v('process.env.NODE_ENV = "production"')]),t._v("的设置！如果您是在 React项目中使用 MobX 的话，就可能已经做好了正确的配置。相关文档："),e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/add-react-to-a-website.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("在网站中添加 React – React"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("p",[e("code",[t._v("observable.*")]),t._v(" api 变得更加简化、一致。此外，现在可以在启用和禁用装饰器语法的情况下使用装饰器。80％到90％的 api 将与 MobX 3 保持一致，但是您还是需要对于某些边界情况做出一些调整。")]),t._v(" "),e("p",[t._v("大多数 api 均已简化。例如，在以往许多 api 将会把第一个参数作为 "),e("code",[t._v("name")]),t._v("，其他额外的指标作为后续的参数。而现在几乎所有的 api 都已经改为将必需的参数优先传入，而后才是作为可选配置的对象。api 变得更简单易读了。")]),t._v(" "),e("p",[t._v("对于 TypeScript 用户，在config中应将"),e("code",[t._v("tslib")]),t._v("设置为"),e("code",[t._v("es6")]),t._v("（编译的目标仍可以为ES5）。")]),t._v(" "),e("h2",{attrs:{id:"已删除的内容"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#已删除的内容","aria-hidden":"true"}},[t._v("#")]),t._v(" 已删除的内容")]),t._v(" "),e("p",[e("em",[t._v("注意：为了使  api 的体积更小，删除了许多已不准备支持的功能。如果您认为不应删除某些功能，请随时提出 issue！")])]),t._v(" "),e("p",[e("code",[t._v("shareGlobalState")]),t._v("已被删除。现有的方法已经足以正确地设置项目 MobX 共享: )。")]),t._v(" "),e("p",[e("code",[t._v("autorun")]),t._v("，"),e("code",[t._v("reaction")]),t._v("，"),e("code",[t._v("runInAction")]),t._v("等方法不再支持接受"),e("code",[t._v("context")]),t._v(" 参数（"),e("code",[t._v("this")]),t._v("）。请改用箭头函数代替。")]),t._v(" "),e("p",[e("code",[t._v("isModifierDescriptor")]),t._v("、"),e("code",[t._v("isStrictModeEnabled")]),t._v("、"),e("code",[t._v("extras.spyReport")]),t._v("、"),e("code",[t._v("extras.spyReportEnd")]),t._v("、"),e("code",[t._v("extras.spyReportStart")]),t._v("、"),e("code",[t._v("extras.isSpyEnabled")]),t._v("等方法将不复存在。")]),t._v(" "),e("p",[e("code",[t._v("whyRun")]),t._v("已被删除，请改用更简洁的 "),e("a",{attrs:{href:"https://cn.mobx.js.org/best/trace.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("trace"),e("OutboundLink")],1),t._v(" 方法。")]),t._v(" "),e("p",[t._v("mobx 的 "),e("code",[t._v("default")]),t._v(" 导出将不再公开。这意味着您不能再通过"),e("code",[t._v('import mobx from "mobx"')]),t._v("的方式引入 mobx，而是显式地导入内容："),e("code",[t._v('import { observable } from "mobx"')]),t._v("。（或使用"),e("code",[t._v('import * as mobx from "mobx"')]),t._v("并终止 tree-shaking）。")]),t._v(" "),e("h2",{attrs:{id:"已迁移的内容"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#已迁移的内容","aria-hidden":"true"}},[t._v("#")]),t._v(" 已迁移的内容")]),t._v(" "),e("p",[t._v("许多方法已经从"),e("code",[t._v("extras")]),t._v("命名空间中转移了。下列 api 中，带有_前缀的仍然是非官方的api（但可以用于测试），无前缀的方法现已正式支持。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("旧API")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("新API")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("useStrict(boolean)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("configure({ enforceActions: boolean })")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("expr")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("现在是"),e("code",[t._v("mobx-utils")]),t._v("包的一部分")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("createTransformer")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("现在是"),e("code",[t._v("mobx-utils")]),t._v("包的一部分")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("map(values)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("observable.map(values)")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.allowStateChanges")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("_allowStateChanges")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.deepEqual")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("comparer.structural")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.getAdministration")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("getAdministration")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.getAtom")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("getAtom")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.getDebugName")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("getDebugName")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.getDependencyTree")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("getDependencyTree")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.getGlobalState")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("_getGlobalState")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.getObserverTree")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("getObserverTree")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.interceptReads")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("_interceptReads")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.isComputingDerivation")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("_isComputingDerivation")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.isolateGlobalState()")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("configure({ isolateGlobalState: true })")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.onReactionError")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("onReactionError")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.reserveArrayBuffer(number)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("configure({ arrayBuffer: number })")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.resetGlobalState")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("_resetGlobalState")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("extras.setReactionScheduler(fn)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("configure({ reactionScheduler : fn })")])])])])]),t._v(" "),e("h2",{attrs:{id:"发生改变的内容"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#发生改变的内容","aria-hidden":"true"}},[t._v("#")]),t._v(" 发生改变的内容")]),t._v(" "),e("h3",{attrs:{id:"不使用装饰器语法（-）的装饰器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#不使用装饰器语法（-）的装饰器","aria-hidden":"true"}},[t._v("#")]),t._v(" 不使用装饰器语法（@）的装饰器")]),t._v(" "),e("p",[e("code",[t._v("observable.ref")]),t._v("，"),e("code",[t._v("observable.shallow")]),t._v("，"),e("code",[t._v("observable.deep")]),t._v("，"),e("code",[t._v("observable.struct")]),t._v("等装饰器方法不再被用作为函数使用，而是通过始终用装饰器的方式使用这些 api，令其更加一致。例如，"),e("code",[t._v("observable.object")]),t._v("和"),e("code",[t._v("extendObservable")]),t._v("现在支持一个"),e("code",[t._v("decorators")]),t._v("参数用于接受装饰器。")]),t._v(" "),e("p",[t._v("其中 Mobx 3 中的装饰器方法，在 Mobx 4 应该改为使用 decorators 参数。例如：")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// MobX 3")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" myObject "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("observable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Michel"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  profile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" observable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("someDataFetchingPromise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// MobX 4")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" myObject "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("observable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Michel"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  profile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" someDataFetchingPromise\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定装饰器.。默认值为'observable'，因此我们只指定了'profile':")]),t._v("\n  profile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" observable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ref   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意：不要加 () !")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br")])]),e("p",[t._v("这种方法的优点是，现在使用"),e("code",[t._v("@decorator")]),t._v("与"),e("code",[t._v("decorator")]),t._v("的效果一致的，两种方式调用方式和接收参数始终相同。例如，下面的几个示例都实现了相同的效果。值得注意的是，切换不同的语法或创建对象的方式是非常方便的：")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Todo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    @observable title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),t._v("\n    @observable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ref promise "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" somePromise\n\n    @computed "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("difficulty")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    @"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" requiresReaction"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expensive")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("somethingExpensive")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    @action "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTitle")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("t")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    @action"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bound "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTitle2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("t")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// observable.object 使用第二个参数 'decorators'，指定需要使用的装饰器。")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对于省略的属性，默认为 `observable` (getters 属性默认为`computed`)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" todo "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" observable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    title"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    promise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" somePromise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("difficulty")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expensive")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("somethingExpensive")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTitle")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("t")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTitle2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("t")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// title: observable 可以省略，当 observable.object / extendobservable 时其将作为默认值。")]),t._v("\n    ref"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" observable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ref"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    expensive"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" requiresReaction"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    setTitle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" action"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    setTitle2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" action"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bound\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 也许您的项目中已经有类，但还没有启用装饰器语法。不用担心，使用 MobX 4 可以让您不走回头路")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 作为在 constructor 中使用`extendObservable`的替代，只需要在`mobx.decorate`中声明相关字段即可增强原型:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Todo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),t._v("\n    promise "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" somePromise\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("difficulty")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expensive")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("somethingExpensive")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTitle")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("t")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTitle2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("t")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("decorate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Todo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    title"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" observable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ref"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" observable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ref"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    expensive"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" requiresReaction"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    setTitle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" action"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    setTitle2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" action"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bound\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br"),e("span",{staticClass:"line-number"},[t._v("34")]),e("br"),e("span",{staticClass:"line-number"},[t._v("35")]),e("br"),e("span",{staticClass:"line-number"},[t._v("36")]),e("br"),e("span",{staticClass:"line-number"},[t._v("37")]),e("br"),e("span",{staticClass:"line-number"},[t._v("38")]),e("br"),e("span",{staticClass:"line-number"},[t._v("39")]),e("br"),e("span",{staticClass:"line-number"},[t._v("40")]),e("br"),e("span",{staticClass:"line-number"},[t._v("41")]),e("br"),e("span",{staticClass:"line-number"},[t._v("42")]),e("br"),e("span",{staticClass:"line-number"},[t._v("43")]),e("br"),e("span",{staticClass:"line-number"},[t._v("44")]),e("br"),e("span",{staticClass:"line-number"},[t._v("45")]),e("br"),e("span",{staticClass:"line-number"},[t._v("46")]),e("br"),e("span",{staticClass:"line-number"},[t._v("47")]),e("br"),e("span",{staticClass:"line-number"},[t._v("48")]),e("br"),e("span",{staticClass:"line-number"},[t._v("49")]),e("br"),e("span",{staticClass:"line-number"},[t._v("50")]),e("br"),e("span",{staticClass:"line-number"},[t._v("51")]),e("br"),e("span",{staticClass:"line-number"},[t._v("52")]),e("br"),e("span",{staticClass:"line-number"},[t._v("53")]),e("br"),e("span",{staticClass:"line-number"},[t._v("54")]),e("br"),e("span",{staticClass:"line-number"},[t._v("55")]),e("br"),e("span",{staticClass:"line-number"},[t._v("56")]),e("br"),e("span",{staticClass:"line-number"},[t._v("57")]),e("br"),e("span",{staticClass:"line-number"},[t._v("58")]),e("br"),e("span",{staticClass:"line-number"},[t._v("59")]),e("br"),e("span",{staticClass:"line-number"},[t._v("60")]),e("br"),e("span",{staticClass:"line-number"},[t._v("61")]),e("br"),e("span",{staticClass:"line-number"},[t._v("62")]),e("br"),e("span",{staticClass:"line-number"},[t._v("63")]),e("br"),e("span",{staticClass:"line-number"},[t._v("64")]),e("br"),e("span",{staticClass:"line-number"},[t._v("65")]),e("br"),e("span",{staticClass:"line-number"},[t._v("66")]),e("br"),e("span",{staticClass:"line-number"},[t._v("67")]),e("br"),e("span",{staticClass:"line-number"},[t._v("68")]),e("br"),e("span",{staticClass:"line-number"},[t._v("69")]),e("br"),e("span",{staticClass:"line-number"},[t._v("70")]),e("br"),e("span",{staticClass:"line-number"},[t._v("71")]),e("br"),e("span",{staticClass:"line-number"},[t._v("72")]),e("br")])]),e("h3",{attrs:{id:"可观察的工厂函数已经被清除"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#可观察的工厂函数已经被清除","aria-hidden":"true"}},[t._v("#")]),t._v(" 可观察的工厂函数已经被清除")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("旧API")]),t._v(" "),e("th",[t._v("新API")]),t._v(" "),e("th",[t._v("注释")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("observable(primitive value)")])]),t._v(" "),e("td",[e("code",[t._v("observable.box(primitive value)")])]),t._v(" "),e("td",[t._v("由于装饰器@observable仍然可以正常工作（也适用于原始值）。如果该值为纯对象，数组或ES6 Map，observable(value)也可以正常使用")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("observable(class instance)")])]),t._v(" "),e("td",[e("code",[t._v("observable.box(class instance)")])]),t._v(" "),e("td",[t._v("由于装饰器@observable仍然可以正常工作（也适用于原始值）。如果该值为纯对象，数组或ES6 Map，observable(value)也可以正常使用")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("observable.shallowArray(values)")])]),t._v(" "),e("td",[e("code",[t._v("observable.array(values, { deep: false })")])]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[e("code",[t._v("observable.shallowMap(values)")])]),t._v(" "),e("td",[e("code",[t._v("observable.map(values, { deep: false })")])]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[e("code",[t._v("observable.shallowObject(values)")])]),t._v(" "),e("td",[e("code",[t._v("observable.object(values, {}, { deep: false })")])]),t._v(" "),e("td",[t._v("注意需要将空对象作为第二个参数，其中可以包含装饰器（请参见上文）")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("extendObservable(target, props, moreProps, evenMoreProps)")])]),t._v(" "),e("td",[e("code",[t._v("extendObservable(target, {...props, ...moreProps, ...evenMoreProps})")])]),t._v(" "),e("td",[t._v("extendObservable不再接受多个参数。而是先合并到一个对象中再解构赋值。")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("extendShallowObservable(target, props)")])]),t._v(" "),e("td",[e("code",[t._v("extendObservable(target, props, {}, { deep: false })")])]),t._v(" "),e("td",[t._v("注意需要将空对象作为第三个参数，其中可以包含装饰器（请参见发行说明）")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("@computed.equals(compareFn)")])]),t._v(" "),e("td",[e("code",[t._v("@computed({ equals: compareFn })")])]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[e("code",[t._v("autorunAsync(fn, delay)")])]),t._v(" "),e("td",[e("code",[t._v("autorun(fn, { delay: delay })")])]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[e("code",[t._v("autorun(name, fn)")])]),t._v(" "),e("td",[e("code",[t._v("autorun(fn, { name: name })")])]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[e("code",[t._v("when(name, predicate, effect)")])]),t._v(" "),e("td",[e("code",[t._v("when(predicate, effect, { name: name })")])]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[e("code",[t._v("reaction(name, expr, effect)")])]),t._v(" "),e("td",[e("code",[t._v("reaction(expr, effect, { name: name })")])]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[e("code",[t._v("isComputed(thing, prop)")])]),t._v(" "),e("td",[e("code",[t._v("isComputedProp(thing, prop)")])]),t._v(" "),e("td",[t._v("isComputed(thing) 仍然可以正常使用")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("isObservable(thing, prop)")])]),t._v(" "),e("td",[e("code",[t._v("isObservableProp(thing, prop)")])]),t._v(" "),e("td",[t._v("isObservable(thing) 仍然可以正常使用")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("new Atom(name, fn, fn)")])]),t._v(" "),e("td",[e("code",[t._v("createAtom(name, fn, fn)")])]),t._v(" "),e("td",[t._v("Atom 类不再直接从包中公开。需要注意的是，现在存在可以在任何MobX可观察对象上使用的全局函数onBecomeObserved并且onBecomeUnobserved，因此在许多情况下，您可能根本不需要创建Atom 的实例。")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("computed(fn, { struct: true }) / computed(fn, { compareStructural: true })")])]),t._v(" "),e("td",[e("code",[t._v("computed(fn, { equals: comparer.structural })")])]),t._v(" "),e("td")])])]),t._v(" "),e("h2",{attrs:{id:"其他改动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他改动","aria-hidden":"true"}},[t._v("#")]),t._v(" 其他改动")]),t._v(" "),e("p",[t._v("MobX 现在需要"),e("code",[t._v("Map")]),t._v("在全局范围内可用，因此需要确保在旧版浏览器中的兼容性（目前支持的是IE 10及更高版本）。如果您使用了"),e("code",[t._v("observable.map()")]),t._v("和序列化，可能需要更新代码。 "),e("code",[t._v("observableMap.toJS()")]),t._v("现在会返回一个"),e("code",[t._v("Map")]),t._v("的普通实例。如果希望转换为普通 JavaScript 对象，请使用"),e("code",[t._v("observableMap.toJSON()")])]),t._v(" "),e("p",[e("code",[t._v("extendObservable")]),t._v("不能再重新声明现有属性，只能引入新属性。应该改用"),e("code",[t._v("set")]),t._v("引入新属性或更新现有属性")]),t._v(" "),e("p",[t._v("所有可迭代的对象都不再创建数组作为迭代器，而只是创建一个真正的迭代器，以求与官方规范更加紧密地对齐。因此，以前的"),e("code",[t._v("observableMap.values()")]),t._v("将返回一个数组作为迭代器，但是现在它将只返回一个迭代器。所以你不能再做类似"),e("code",[t._v("observableMap.values().map(fn)")]),t._v("的操作。而是使用"),e("code",[t._v("Array.from(observableMap.values()).map(fn)")]),t._v("或"),e("code",[t._v("mobx.values(observableMap).map(fn)")]),t._v("。受影响的迭代器有：1.可观察数组的默认迭代器。2.可观察映射的默认迭代器。包括"),e("code",[t._v("observableMap.entries()")]),t._v("，"),e("code",[t._v("observableMap.keys()")]),t._v("和"),e("code",[t._v("observableMap.values()")]),t._v("。")]),t._v(" "),e("p",[t._v("传递给"),e("code",[t._v("spy")]),t._v("处理函数的参数已稍作更改。")]),t._v(" "),e("p",[t._v("如果"),e("code",[t._v("reportObserved")]),t._v("在反应性上下文之外被触发，在自建 atom 中调用"),e("code",[t._v("reportObserved()")]),t._v("将不再触发钩子。")])])},[],!1,null,null,null);s.default=n.exports}}]);