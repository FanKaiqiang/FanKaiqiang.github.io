<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【归纳】JS 函数复习 | Franko&#39;s Blog</title>
    <meta name="description" content="长江一帆远，落日五湖春。">
    <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.82618647.css" as="style"><link rel="preload" href="/assets/js/app.20586f85.js" as="script"><link rel="preload" href="/assets/js/3.a975d71c.js" as="script"><link rel="preload" href="/assets/js/1.f9715dde.js" as="script"><link rel="preload" href="/assets/js/98.3035542d.js" as="script"><link rel="prefetch" href="/assets/js/10.3713fa2b.js"><link rel="prefetch" href="/assets/js/100.c7e8673f.js"><link rel="prefetch" href="/assets/js/101.29a59833.js"><link rel="prefetch" href="/assets/js/102.3fbd0f95.js"><link rel="prefetch" href="/assets/js/103.72c6e9b5.js"><link rel="prefetch" href="/assets/js/104.f6f27012.js"><link rel="prefetch" href="/assets/js/105.0d66958f.js"><link rel="prefetch" href="/assets/js/106.290db28e.js"><link rel="prefetch" href="/assets/js/107.e20e3803.js"><link rel="prefetch" href="/assets/js/108.cd45cee0.js"><link rel="prefetch" href="/assets/js/109.4ba3d58f.js"><link rel="prefetch" href="/assets/js/11.3f5de7ee.js"><link rel="prefetch" href="/assets/js/110.0d55c579.js"><link rel="prefetch" href="/assets/js/111.3648d92a.js"><link rel="prefetch" href="/assets/js/112.cf39ecb8.js"><link rel="prefetch" href="/assets/js/113.6f2fdbc4.js"><link rel="prefetch" href="/assets/js/114.77c92b08.js"><link rel="prefetch" href="/assets/js/115.0656b5e6.js"><link rel="prefetch" href="/assets/js/116.80cf31f3.js"><link rel="prefetch" href="/assets/js/117.2b92a260.js"><link rel="prefetch" href="/assets/js/118.c06968f3.js"><link rel="prefetch" href="/assets/js/119.20ab4e08.js"><link rel="prefetch" href="/assets/js/12.19e53560.js"><link rel="prefetch" href="/assets/js/120.97d79ae7.js"><link rel="prefetch" href="/assets/js/121.f6da62ca.js"><link rel="prefetch" href="/assets/js/122.859caf01.js"><link rel="prefetch" href="/assets/js/13.dda8f215.js"><link rel="prefetch" href="/assets/js/14.2a592289.js"><link rel="prefetch" href="/assets/js/15.4925e3a4.js"><link rel="prefetch" href="/assets/js/16.0f840892.js"><link rel="prefetch" href="/assets/js/17.3e801416.js"><link rel="prefetch" href="/assets/js/18.b4d3a92e.js"><link rel="prefetch" href="/assets/js/19.f9cee7a0.js"><link rel="prefetch" href="/assets/js/20.3f33780e.js"><link rel="prefetch" href="/assets/js/21.ed566f24.js"><link rel="prefetch" href="/assets/js/22.94f8e887.js"><link rel="prefetch" href="/assets/js/23.fb38ed6e.js"><link rel="prefetch" href="/assets/js/24.dd36a8c2.js"><link rel="prefetch" href="/assets/js/25.bb6cacf5.js"><link rel="prefetch" href="/assets/js/26.c86a26fa.js"><link rel="prefetch" href="/assets/js/27.2dd1516a.js"><link rel="prefetch" href="/assets/js/28.83a01027.js"><link rel="prefetch" href="/assets/js/29.fcd25cd4.js"><link rel="prefetch" href="/assets/js/30.a1c1c82d.js"><link rel="prefetch" href="/assets/js/31.274c9b5e.js"><link rel="prefetch" href="/assets/js/32.f75d4ae9.js"><link rel="prefetch" href="/assets/js/33.1e4d92da.js"><link rel="prefetch" href="/assets/js/34.4ef7ac99.js"><link rel="prefetch" href="/assets/js/35.4f47ea1f.js"><link rel="prefetch" href="/assets/js/36.f1911a7c.js"><link rel="prefetch" href="/assets/js/37.b562ea4c.js"><link rel="prefetch" href="/assets/js/38.b862a71d.js"><link rel="prefetch" href="/assets/js/39.0a74782b.js"><link rel="prefetch" href="/assets/js/4.46f5c0e2.js"><link rel="prefetch" href="/assets/js/40.f75bdd02.js"><link rel="prefetch" href="/assets/js/41.62a05ca3.js"><link rel="prefetch" href="/assets/js/42.1a733cf6.js"><link rel="prefetch" href="/assets/js/43.7506e026.js"><link rel="prefetch" href="/assets/js/44.568d2265.js"><link rel="prefetch" href="/assets/js/45.50e5cd0c.js"><link rel="prefetch" href="/assets/js/46.2c3c32c9.js"><link rel="prefetch" href="/assets/js/47.f9a54e6b.js"><link rel="prefetch" href="/assets/js/48.32da44eb.js"><link rel="prefetch" href="/assets/js/49.df6b0b62.js"><link rel="prefetch" href="/assets/js/5.bb6aabf2.js"><link rel="prefetch" href="/assets/js/50.52d40ed6.js"><link rel="prefetch" href="/assets/js/51.e7a7badb.js"><link rel="prefetch" href="/assets/js/52.6a20c4e8.js"><link rel="prefetch" href="/assets/js/53.2747af5b.js"><link rel="prefetch" href="/assets/js/54.02396d0d.js"><link rel="prefetch" href="/assets/js/55.7b929339.js"><link rel="prefetch" href="/assets/js/56.f24df74e.js"><link rel="prefetch" href="/assets/js/57.a39d5e97.js"><link rel="prefetch" href="/assets/js/58.b13862f5.js"><link rel="prefetch" href="/assets/js/59.b2ef3cb1.js"><link rel="prefetch" href="/assets/js/6.9a323443.js"><link rel="prefetch" href="/assets/js/60.3b294663.js"><link rel="prefetch" href="/assets/js/61.23d3575f.js"><link rel="prefetch" href="/assets/js/62.9c1cd3c8.js"><link rel="prefetch" href="/assets/js/63.4376c00d.js"><link rel="prefetch" href="/assets/js/64.59741dd5.js"><link rel="prefetch" href="/assets/js/65.8e59eee4.js"><link rel="prefetch" href="/assets/js/66.a07156ca.js"><link rel="prefetch" href="/assets/js/67.bad8de6a.js"><link rel="prefetch" href="/assets/js/68.348f3c6f.js"><link rel="prefetch" href="/assets/js/69.27403668.js"><link rel="prefetch" href="/assets/js/7.7376f609.js"><link rel="prefetch" href="/assets/js/70.e105d08d.js"><link rel="prefetch" href="/assets/js/71.3912c588.js"><link rel="prefetch" href="/assets/js/72.2e803182.js"><link rel="prefetch" href="/assets/js/73.698bb062.js"><link rel="prefetch" href="/assets/js/74.6eb02d59.js"><link rel="prefetch" href="/assets/js/75.5e85377b.js"><link rel="prefetch" href="/assets/js/76.a50ad35f.js"><link rel="prefetch" href="/assets/js/77.9923eba2.js"><link rel="prefetch" href="/assets/js/78.30d80868.js"><link rel="prefetch" href="/assets/js/79.b0633c2f.js"><link rel="prefetch" href="/assets/js/8.effb8ee5.js"><link rel="prefetch" href="/assets/js/80.1c7129b4.js"><link rel="prefetch" href="/assets/js/81.757e25f5.js"><link rel="prefetch" href="/assets/js/82.04a6c134.js"><link rel="prefetch" href="/assets/js/83.a5425512.js"><link rel="prefetch" href="/assets/js/84.478c64ab.js"><link rel="prefetch" href="/assets/js/85.e304024e.js"><link rel="prefetch" href="/assets/js/86.46d38efd.js"><link rel="prefetch" href="/assets/js/87.8ab01c2a.js"><link rel="prefetch" href="/assets/js/88.695a06d9.js"><link rel="prefetch" href="/assets/js/89.2b9afe77.js"><link rel="prefetch" href="/assets/js/9.a3297750.js"><link rel="prefetch" href="/assets/js/90.6dd7f214.js"><link rel="prefetch" href="/assets/js/91.891f6634.js"><link rel="prefetch" href="/assets/js/92.32bd7ffa.js"><link rel="prefetch" href="/assets/js/93.646030b0.js"><link rel="prefetch" href="/assets/js/94.2df43ae3.js"><link rel="prefetch" href="/assets/js/95.ca4e89a0.js"><link rel="prefetch" href="/assets/js/96.4b4fcf2a.js"><link rel="prefetch" href="/assets/js/97.705f40c5.js"><link rel="prefetch" href="/assets/js/99.40877126.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82618647.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Franko's Blog</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/笔记.html" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/category/随笔.html" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/category/项目总结.html" class="nav-link"><i class="iconfont undefined"></i>
  项目总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读书记录.html" class="nav-link"><i class="iconfont undefined"></i>
  读书记录
</a></li><li class="dropdown-item"><!----> <a href="/category/翻译.html" class="nav-link"><i class="iconfont undefined"></i>
  翻译
</a></li><li class="dropdown-item"><!----> <a href="/category/关于我.html" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/笔记.html" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/category/随笔.html" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/category/项目总结.html" class="nav-link"><i class="iconfont undefined"></i>
  项目总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读书记录.html" class="nav-link"><i class="iconfont undefined"></i>
  读书记录
</a></li><li class="dropdown-item"><!----> <a href="/category/翻译.html" class="nav-link"><i class="iconfont undefined"></i>
  翻译
</a></li><li class="dropdown-item"><!----> <a href="/category/关于我.html" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>2020</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>九月</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2009/20200919A.html" class="sidebar-link">【归纳】代码优化技巧与可读性</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>五月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>四月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>三月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>二月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>一月</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2019</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2018</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>【归纳】JS 函数复习</h1> <hr> <div data-v-b53d65a4><i class="iconfont reco-account" data-v-b53d65a4><span data-v-b53d65a4>广宇</span></i> <i class="iconfont reco-date" data-v-b53d65a4><span data-v-b53d65a4>2019-8-25</span></i> <!----> <i class="iconfont reco-tag tags" data-v-b53d65a4><span class="tag-item" data-v-b53d65a4>
      JavaScript
    </span></i></div></div> <div class="content__default"><div class="tip custom-block"><p>本来打算八月份开始好好写博客，可是到现在才勉强能够开始写一篇，还不知道能不能写完。这篇博客是我这几天抽时间看课程看的一些内容，总得来说都是以前的一些学过的知识。是关于 JavaScript 函数的，相当基础。</p></div> <p>尽管如此，还是有许多地方不能够说是完全掌握了，所以今天把一些有必要记下来的一些内容记一下，希望今天能把这篇博客肝出来，不然这个月基本就摸鱼摸掉了。</p><div style="text-align:center;"><img src="20190824A/1.jpg" alt="摸鱼"></div><p></p> <h2 id="一、函数的返回值"><a href="#一、函数的返回值" aria-hidden="true" class="header-anchor">#</a> 一、函数的返回值</h2> <p>平时经常用到函数，但是要说函数是什么，却不一定答得上来。实际上，早在学生时代，大家就开始接触函数了。就数学领域上来说，大概可以这么理解，函数是定义域与值域的一一对应的这种关系。数学函数一定有输入和输出，且不管在何时，一个输入都对应唯一一种输出。但是在 JavaScript 中，函数并非如此，或者可以说是两种不同的概念。那么编程中的函数是怎么来的呢？</p> <p>在最开始，人们编程在的时候，把「一个过多个语句组成完成特定任务，而且相对独立」的一部分代码称为<strong>子程序</strong>。而再把子程序进行细分，把有返回值的子程序称为<strong>函数</strong>，没有返回值的称为<strong>过程</strong>，在类或对象中的子程序称作<strong>方法</strong>。这里的函数就是平时在编程中提到的函数，在 JavaScript 中，可以知道，函数全都是有返回值的，如果函数在未设置返回值，这个时候返回值就是<code>undefined</code>。所以 JavaScript 中有「函数」和「方法」，并没有「过程」。如果函数符合数学函数的定义，就可以称这个函数是「函数式」的。</p> <p>刚才谈到了，函数都是有返回值的。JavaScript 中的函数一般来说并不一定一个输入对应唯一一种输出，那么函数的返回值是由什么确定的呢？可以通过两个因素确定：<strong>调用时</strong>的参数（params）和<strong>定义时</strong>的环境（env）。譬如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token string">'x'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token string">'3'</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">'2'</span><span class="token punctuation">;</span>
    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token string">'4'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>上面代码中调用了<code>f1</code>的返回值会是多少呢？这个函数调用时的参数是<code>'x'</code>，是可以确定的，但是这个<code>a</code>是指哪个 a 就不确定了。是块级作用域内定义的 a 还是外面定义的 a 呢？这个问题一开始我是答错了的，我以为结果是<code>'x2'</code>，结果结果是<code>'x3'</code>。可以这么理解，这里的 a 并不属于参数，而是属于函数定义时的环境的一部分，因此这个时候函数中的 a 已经被绑定为块级作用域外定义的 a。不过虽然绑定了这个 a，但是绑定的并不是 a 的值，所以这里获得的 a 重新赋值之后的值。至于为什么不是<code>'4'</code>，那是因为这次赋值已经在函数调用之后了。</p> <p>上面的例子算是比较简单的，下面是另一个例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token string">'x'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">'2'</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x <span class="token operator">+</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">f1</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>这里面有个函数套函数的情景，所以更复杂一点点。实际上，例子里先是以<code>f2</code>为参数，调用<code>f1</code>。而<code>f1</code>里面就只是简单地调用了<code>f2</code>，所以可以看作单纯的<code>f2</code>的调用，<code>f2</code>是在块级作用域内声明的，所以这里的 a 绑定的是<code>'2'</code>，至于 x，因为本作用域里没有声明 x，所以会回溯到父级作用域里找 x。因此结果是<code>'x2'</code>，实际上也不太难。因为前一个例子已经搞清楚了函数返回值的确定因素，就是调用时的参数和定义时的环境，仔细分析一下就可以得出结果。</p> <h2 id="二、闭包"><a href="#二、闭包" aria-hidden="true" class="header-anchor">#</a> 二、闭包</h2> <p>这里可以看出，两个例子中的 a 都是在函数外部声明的变量，再在函数里面对其进行访问。前面也学过（都要忘了），这种函数里面访问外面的变量的情况，函数与这个变量之间就形成了<strong>闭包</strong>。关于这个知识点，之前也是写过博客的，这篇<a href="/1811/20181122A">关于「闭包」的博客</a>写的内容还不少，复习的时候可以来看看，这里就不细讲了。</p> <p>闭包有如下特点：</p> <ul><li>能让一个函数维持一个变量</li> <li>不能维持这个变量的值</li> <li>尤其是变量值发生变化的时候</li></ul> <p>关于变量值发生变化这一点，有一个比较老的面试题，已经烂大街了，可以看一下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 6个6</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 0、1、2、3、4、5</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>结果页不用多说了，上面使用<code>var</code>声明的会打印出六个<code>6</code>，使用<code>let</code>则不会。这是由<code>let</code>的特点导致的，之前的博客里也讲过。由这个例子可以看出闭包虽然维持了变量，但是维持不了在不断变化的值。随便提一句，除了使用<code>let</code>，使用立即执行函数也可以实现相同的效果，这是因为函数里面是一个不同的作用域，把当前的<code>i</code>的值保存了下来：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 0、1、2、3、4、5</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如果不用闭包，使用对象也可以用来维持一个变量，这时候就要用到<code>this</code>了。这时候是通过「对象」+「属性」来维持变量的，如果一门语言不支持闭包，就可以用对象来代理，反之亦同：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    i<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>关于对象维持变量这点，这节课的课后有一个练习题。题目中要求实现一个可以封装其他函数的函数，使得多次调用函数时，函数不必多次重复计算，而是直接读取「记忆」中的值。在做题之前，我总觉得函数要「记忆」住一个值，总得依靠外部的变量才行，也就是闭包。后面看了这题的结果，才想起函数也属于变量，可以借助对象来维持这个变量：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">memo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">newFn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> newFn<span class="token punctuation">.</span>memo<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 注意 memo 只会以第一个参数作为记忆点，但是还是会用 arguments 来调用 fn</span>
            newFn<span class="token punctuation">.</span>memo<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> newFn<span class="token punctuation">.</span>memo<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    newFn<span class="token punctuation">.</span>memo <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> newFn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> x2 <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行了一次'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 第一次调用 x2(1)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 打印出执行了，并且返回2</span>
  <span class="token comment">// 第二次调用 x2(1)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 不打印执行，并且返回上次的结果2</span>
  <span class="token comment">// 第三次调用 x2(1)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 不打印执行，并且返回上次的结果2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="三、this-经典面试题"><a href="#三、this-经典面试题" aria-hidden="true" class="header-anchor">#</a> 三、this 经典面试题</h2> <p>函数有四种声明方法，早在最开始就学过了，还写了<a href="/1810/20181030A">博客</a>，这里就不多说了。这几种方法中，箭头函数是比较特殊的，其他几种支持<code>this</code>、<code>arguments</code>、<code>New</code>，箭头函数不支持。为什么会这样讲，可以这样理解，箭头函数把<code>this</code>当作等同于其他变量的一个普通变量（env），或者说是一个名叫 this 的变量，而其他函数把<code>this</code>当作参数（params）来看待，是有特殊处理的。对于<code>this</code>而言，如果是普通函数，如果不知道它是如何调用的话，就无法知道<code>this</code>指向哪里。比如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>button<span class="token punctuation">.</span><span class="token function-variable function">onClick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>一眼往上去，就感觉这里的<code>this</code>指向的应该是<code>&lt;button&gt;</code>元素。可实际上只有在用户点击按钮调用这个函数的时候，<code>this</code>才会指向<code>&lt;button&gt;</code>元素。因为这个函数还是有可能被<code>call</code>指定<code>this</code>的，<code>this</code>在不被调用时是无法确定的。</p> <p>这里有一道非常「鬼魅」的面试题，在见到这道题之前我以为我已经掌握了<code>this</code>，做完之后我才知道我还差得远。题目大概是这样的：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> length <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    length<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token function">method</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>究竟这两下会打印出什么？一眼看去，首先他调用的是<code>obj.method</code>，那第一个<code>this</code>指的肯定是<code>obj</code>，那打印的肯定是<code>5</code>了？事实上并不是这样，第一次输出的时候是在代码的第 8 行，这里<code>fn</code>使用最普通的方法调用的，并没有指定<code>this</code>。在没有指定的情况<code>this</code>就是<code>window</code>了，所以此处的<code>this</code>是<code>window</code>。</p> <p>可以看到，在全局作用域声明了一个<code>length</code>，那打印了的就是<code>10</code>了吗？那样的话就又错了，即使在全局作用域，使用<code>let</code>声明的变量也不会被挂在<code>window</code>上。那这里的<code>length</code>就是<code>window</code>本来的<code>length</code>，<code>window.length</code>又是何方神圣呢？我之前也从来没有听说过这个问题，直接看<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/length" target="_blank" rel="noopener noreferrer">MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>是怎么说的：</p> <blockquote><p>返回当前窗口中包含的框架数量(框架包括frame和iframe两种元素).</p></blockquote> <p>这下就搞明白了，这个问题没法回答，因为并不知道当前页面的框架数量嘛。这个问题真是一波三折，可是还没完，函数又以<code>arguments[0]</code>的形式又调用了一次，这里的<code>this</code>又是指的哪个？可以看出<code>obj.method</code>的第 0 个参数就是<code>fn</code>，实际上就是有调了一遍<code>fn</code>。为了更好分析<code>this</code>，可以把<code>arguments[0]</code>改写为<code>call</code>的形式来调用：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里是比较好理解的，因为<code>arguments</code>是个对象，是在调用它的方法，<code>this</code>当然指向<code>arguments</code>。那他问的就是<code>arguments.length</code>了。这又涉及到一个问题，大家都知道<code>arguments</code>是函数的参数组成的伪数组，但是它指的是形参还是实参呢？可以看到，这个函数的形参就只有一个<code>fn</code>，而实参却多传了一个<code>1</code>，所以有两个实参。看<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/arguments/length" target="_blank" rel="noopener noreferrer">MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>就可以知道了：</p> <blockquote><p>本次函数调用时传入函数的实参数量.</p></blockquote> <p>问题就解决了，<code>this</code>既不是<code>5</code>，也不是<code>10</code>，而是两个毫不相干的值，却又牵扯到了其他方面的知识点，可以说是相当经典了。比较重要地，遇到这种题目，把函数的调用方式改为<code>call</code>的形式，分析起来会清楚很多。因为<code>this</code>就是<code>call</code>的第一个参数，不用<code>call</code>调用的话，就没法确定<code>this</code>啦。</p> <hr> <p>以上就是今天的博客的内容，写的内容不多，知识也很浅，主要都是一些复习向的，都不是什么新知识嘛。当然也不是毫无意义，这个可以这么说，写的这三个点我都觉得可能是我之前还没有弄明白的地方。当然事实上这节课还有下半部分的内容，不过博客并不适合写那么长（太长不看）。这次也算是一次久违的博客了，好久没有这么静下来写一篇博客了，希望以后可以坚持输出自己的内容吧。希望明天可以正常地走着去上班😂。</p><div style="text-align:center;"><img src="20190824A/timg.jpg" alt="爬着去上班"></div><p></p> <h4 id="再编辑于-2019-9-30-14-50-56"><a href="#再编辑于-2019-9-30-14-50-56" aria-hidden="true" class="header-anchor">#</a> 再编辑于 2019-9-30 14:50:56</h4> <p>这篇博客竟然被 dark 佬翻牌了，还被 dark 佬点出一个错误，我简直要高兴得喷鼻血了。这给了我极大的帮助，没有在错误的道路上玩火自焚。为了方便路过的人了解到 dark 佬，也为了我继续学习，这里标注一下 dark 佬的博客：<a href="https://blog.csdn.net/qq_38958113" target="_blank" rel="noopener noreferrer">红尘浪子四码中特<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。可以看到里面迷弟如云，干货十足，虽然我都看不懂，但是打尻还是要的。</p><div style="text-align:center;"><img src="20190824A/2.jpg" alt="大佬的迷弟"></div><p></p></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">1/19/2020, 2:08:27 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/1909/20190924A.html" class="prev">
          【笔记】HTTP 协议基础
        </a></span> <span class="next"><a href="/1908/20190825A.html">
          【归纳】JS的递归与优化
        </a>
        →
      </span></p></div> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.20586f85.js" defer></script><script src="/assets/js/3.a975d71c.js" defer></script><script src="/assets/js/1.f9715dde.js" defer></script><script src="/assets/js/98.3035542d.js" defer></script>
  </body>
</html>
