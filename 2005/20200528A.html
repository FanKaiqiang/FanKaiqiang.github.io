<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【翻译】MobX 4：更优秀、简易、快捷、轻便 | Franko&#39;s Blog</title>
    <meta name="description" content="长江一帆远，落日五湖春。">
    <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.82618647.css" as="style"><link rel="preload" href="/assets/js/app.20586f85.js" as="script"><link rel="preload" href="/assets/js/3.a975d71c.js" as="script"><link rel="preload" href="/assets/js/1.f9715dde.js" as="script"><link rel="preload" href="/assets/js/116.80cf31f3.js" as="script"><link rel="prefetch" href="/assets/js/10.3713fa2b.js"><link rel="prefetch" href="/assets/js/100.c7e8673f.js"><link rel="prefetch" href="/assets/js/101.29a59833.js"><link rel="prefetch" href="/assets/js/102.3fbd0f95.js"><link rel="prefetch" href="/assets/js/103.72c6e9b5.js"><link rel="prefetch" href="/assets/js/104.f6f27012.js"><link rel="prefetch" href="/assets/js/105.0d66958f.js"><link rel="prefetch" href="/assets/js/106.290db28e.js"><link rel="prefetch" href="/assets/js/107.e20e3803.js"><link rel="prefetch" href="/assets/js/108.cd45cee0.js"><link rel="prefetch" href="/assets/js/109.4ba3d58f.js"><link rel="prefetch" href="/assets/js/11.3f5de7ee.js"><link rel="prefetch" href="/assets/js/110.0d55c579.js"><link rel="prefetch" href="/assets/js/111.3648d92a.js"><link rel="prefetch" href="/assets/js/112.cf39ecb8.js"><link rel="prefetch" href="/assets/js/113.6f2fdbc4.js"><link rel="prefetch" href="/assets/js/114.77c92b08.js"><link rel="prefetch" href="/assets/js/115.0656b5e6.js"><link rel="prefetch" href="/assets/js/117.2b92a260.js"><link rel="prefetch" href="/assets/js/118.c06968f3.js"><link rel="prefetch" href="/assets/js/119.20ab4e08.js"><link rel="prefetch" href="/assets/js/12.19e53560.js"><link rel="prefetch" href="/assets/js/120.97d79ae7.js"><link rel="prefetch" href="/assets/js/121.f6da62ca.js"><link rel="prefetch" href="/assets/js/122.859caf01.js"><link rel="prefetch" href="/assets/js/13.dda8f215.js"><link rel="prefetch" href="/assets/js/14.2a592289.js"><link rel="prefetch" href="/assets/js/15.4925e3a4.js"><link rel="prefetch" href="/assets/js/16.0f840892.js"><link rel="prefetch" href="/assets/js/17.3e801416.js"><link rel="prefetch" href="/assets/js/18.b4d3a92e.js"><link rel="prefetch" href="/assets/js/19.f9cee7a0.js"><link rel="prefetch" href="/assets/js/20.3f33780e.js"><link rel="prefetch" href="/assets/js/21.ed566f24.js"><link rel="prefetch" href="/assets/js/22.94f8e887.js"><link rel="prefetch" href="/assets/js/23.fb38ed6e.js"><link rel="prefetch" href="/assets/js/24.dd36a8c2.js"><link rel="prefetch" href="/assets/js/25.bb6cacf5.js"><link rel="prefetch" href="/assets/js/26.c86a26fa.js"><link rel="prefetch" href="/assets/js/27.2dd1516a.js"><link rel="prefetch" href="/assets/js/28.83a01027.js"><link rel="prefetch" href="/assets/js/29.fcd25cd4.js"><link rel="prefetch" href="/assets/js/30.a1c1c82d.js"><link rel="prefetch" href="/assets/js/31.274c9b5e.js"><link rel="prefetch" href="/assets/js/32.f75d4ae9.js"><link rel="prefetch" href="/assets/js/33.1e4d92da.js"><link rel="prefetch" href="/assets/js/34.4ef7ac99.js"><link rel="prefetch" href="/assets/js/35.4f47ea1f.js"><link rel="prefetch" href="/assets/js/36.f1911a7c.js"><link rel="prefetch" href="/assets/js/37.b562ea4c.js"><link rel="prefetch" href="/assets/js/38.b862a71d.js"><link rel="prefetch" href="/assets/js/39.0a74782b.js"><link rel="prefetch" href="/assets/js/4.46f5c0e2.js"><link rel="prefetch" href="/assets/js/40.f75bdd02.js"><link rel="prefetch" href="/assets/js/41.62a05ca3.js"><link rel="prefetch" href="/assets/js/42.1a733cf6.js"><link rel="prefetch" href="/assets/js/43.7506e026.js"><link rel="prefetch" href="/assets/js/44.568d2265.js"><link rel="prefetch" href="/assets/js/45.50e5cd0c.js"><link rel="prefetch" href="/assets/js/46.2c3c32c9.js"><link rel="prefetch" href="/assets/js/47.f9a54e6b.js"><link rel="prefetch" href="/assets/js/48.32da44eb.js"><link rel="prefetch" href="/assets/js/49.df6b0b62.js"><link rel="prefetch" href="/assets/js/5.bb6aabf2.js"><link rel="prefetch" href="/assets/js/50.52d40ed6.js"><link rel="prefetch" href="/assets/js/51.e7a7badb.js"><link rel="prefetch" href="/assets/js/52.6a20c4e8.js"><link rel="prefetch" href="/assets/js/53.2747af5b.js"><link rel="prefetch" href="/assets/js/54.02396d0d.js"><link rel="prefetch" href="/assets/js/55.7b929339.js"><link rel="prefetch" href="/assets/js/56.f24df74e.js"><link rel="prefetch" href="/assets/js/57.a39d5e97.js"><link rel="prefetch" href="/assets/js/58.b13862f5.js"><link rel="prefetch" href="/assets/js/59.b2ef3cb1.js"><link rel="prefetch" href="/assets/js/6.9a323443.js"><link rel="prefetch" href="/assets/js/60.3b294663.js"><link rel="prefetch" href="/assets/js/61.23d3575f.js"><link rel="prefetch" href="/assets/js/62.9c1cd3c8.js"><link rel="prefetch" href="/assets/js/63.4376c00d.js"><link rel="prefetch" href="/assets/js/64.59741dd5.js"><link rel="prefetch" href="/assets/js/65.8e59eee4.js"><link rel="prefetch" href="/assets/js/66.a07156ca.js"><link rel="prefetch" href="/assets/js/67.bad8de6a.js"><link rel="prefetch" href="/assets/js/68.348f3c6f.js"><link rel="prefetch" href="/assets/js/69.27403668.js"><link rel="prefetch" href="/assets/js/7.7376f609.js"><link rel="prefetch" href="/assets/js/70.e105d08d.js"><link rel="prefetch" href="/assets/js/71.3912c588.js"><link rel="prefetch" href="/assets/js/72.2e803182.js"><link rel="prefetch" href="/assets/js/73.698bb062.js"><link rel="prefetch" href="/assets/js/74.6eb02d59.js"><link rel="prefetch" href="/assets/js/75.5e85377b.js"><link rel="prefetch" href="/assets/js/76.a50ad35f.js"><link rel="prefetch" href="/assets/js/77.9923eba2.js"><link rel="prefetch" href="/assets/js/78.30d80868.js"><link rel="prefetch" href="/assets/js/79.b0633c2f.js"><link rel="prefetch" href="/assets/js/8.effb8ee5.js"><link rel="prefetch" href="/assets/js/80.1c7129b4.js"><link rel="prefetch" href="/assets/js/81.757e25f5.js"><link rel="prefetch" href="/assets/js/82.04a6c134.js"><link rel="prefetch" href="/assets/js/83.a5425512.js"><link rel="prefetch" href="/assets/js/84.478c64ab.js"><link rel="prefetch" href="/assets/js/85.e304024e.js"><link rel="prefetch" href="/assets/js/86.46d38efd.js"><link rel="prefetch" href="/assets/js/87.8ab01c2a.js"><link rel="prefetch" href="/assets/js/88.695a06d9.js"><link rel="prefetch" href="/assets/js/89.2b9afe77.js"><link rel="prefetch" href="/assets/js/9.a3297750.js"><link rel="prefetch" href="/assets/js/90.6dd7f214.js"><link rel="prefetch" href="/assets/js/91.891f6634.js"><link rel="prefetch" href="/assets/js/92.32bd7ffa.js"><link rel="prefetch" href="/assets/js/93.646030b0.js"><link rel="prefetch" href="/assets/js/94.2df43ae3.js"><link rel="prefetch" href="/assets/js/95.ca4e89a0.js"><link rel="prefetch" href="/assets/js/96.4b4fcf2a.js"><link rel="prefetch" href="/assets/js/97.705f40c5.js"><link rel="prefetch" href="/assets/js/98.3035542d.js"><link rel="prefetch" href="/assets/js/99.40877126.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82618647.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Franko's Blog</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/笔记.html" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/category/随笔.html" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/category/项目总结.html" class="nav-link"><i class="iconfont undefined"></i>
  项目总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读书记录.html" class="nav-link"><i class="iconfont undefined"></i>
  读书记录
</a></li><li class="dropdown-item"><!----> <a href="/category/翻译.html" class="nav-link"><i class="iconfont undefined"></i>
  翻译
</a></li><li class="dropdown-item"><!----> <a href="/category/关于我.html" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/笔记.html" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/category/随笔.html" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/category/项目总结.html" class="nav-link"><i class="iconfont undefined"></i>
  项目总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读书记录.html" class="nav-link"><i class="iconfont undefined"></i>
  读书记录
</a></li><li class="dropdown-item"><!----> <a href="/category/翻译.html" class="nav-link"><i class="iconfont undefined"></i>
  翻译
</a></li><li class="dropdown-item"><!----> <a href="/category/关于我.html" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>2020</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>九月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>五月</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2005/20200528A.html" class="active sidebar-link">【翻译】MobX 4：更优秀、简易、快捷、轻便</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/2005/20200528A.html#本文大纲" class="sidebar-link">本文大纲</a></li><li class="sidebar-sub-header"><a href="/2005/20200528A.html#没有装饰器语法（-）的装饰器" class="sidebar-link">没有装饰器语法（@）的装饰器</a></li><li class="sidebar-sub-header"><a href="/2005/20200528A.html#动态扩展可观察对象" class="sidebar-link">动态扩展可观察对象</a></li><li class="sidebar-sub-header"><a href="/2005/20200528A.html#改进了对异步进程的支持" class="sidebar-link">改进了对异步进程的支持</a></li><li class="sidebar-sub-header"><a href="/2005/20200528A.html#资源管理" class="sidebar-link">资源管理</a></li><li class="sidebar-sub-header"><a href="/2005/20200528A.html#更快捷、轻便" class="sidebar-link">更快捷、轻便</a></li><li class="sidebar-sub-header"><a href="/2005/20200528A.html#更多" class="sidebar-link">更多</a></li></ul></li><li><a href="/2005/20200531A.html" class="sidebar-link">【翻译】从 Mobx 3 迁移到 Mobx 4</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>四月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>三月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>二月</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>一月</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2019</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2018</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>【翻译】MobX 4：更优秀、简易、快捷、轻便</h1> <hr> <div data-v-b53d65a4><i class="iconfont reco-account" data-v-b53d65a4><span data-v-b53d65a4>广宇</span></i> <i class="iconfont reco-date" data-v-b53d65a4><span data-v-b53d65a4>2020-5-29</span></i> <!----> <i class="iconfont reco-tag tags" data-v-b53d65a4><span class="tag-item" data-v-b53d65a4>
      Mobx
    </span></i></div></div> <div class="content__default"><div class="tip custom-block"><p>转眼间这个月就到了月末，从庐山回来到现在天天都来公司上班，都没停下来过，博客和课程都没什么心思看。这篇文章是在上个月末比较空闲的翻的关于 Mobx 4 的一篇文章。在工作之前，自己几乎没有接触过 Mobx，只是在工作使用中不断边学边用，现在也只能说是一知半解。虽然现在只是为了准备项目的 Mobx 升级才翻的几篇文章，不过借助这几篇文章的翻译，也算是帮助了我学习了不少 Mobx 的知识。</p></div> <p>这篇文章是 Mobx 作者写的一篇关于 Mobx 4 的介绍，概括了 Mobx 4 中的重要更新内容。</p><div style="text-align:center;"><img src="https://s1.ax1x.com/2020/05/28/teslge.jpg" alt="封面"></div><p></p> <blockquote><p>翻译原文：<a href="https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da" target="_blank" rel="noopener noreferrer">MobX 4: Better, simpler, faster, smaller - Michel Weststrate - Medium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>而且，Mobx 5 将会更加出色😺</p> <p>在这里我可以很自豪地宣布，新的<a href="https://mobx.js.org/" target="_blank" rel="noopener noreferrer">MobX<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>大版本已经发布！版本更新<a href="https://github.com/mobxjs/mobx/blob/master/CHANGELOG.md#400" target="_blank" rel="noopener noreferrer">日志<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>相当长，其中还包含一份<a href="https://github.com/mobxjs/mobx/wiki/Migrating-from-mobx-3-to-mobx-4" target="_blank" rel="noopener noreferrer">迁移指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。因此，在本篇博客中我将重点介绍一些值得关注的新功能。顺便说一句，如果您还不熟悉 MobX，可以留意一下免费的 <a href="https://egghead.io/courses/manage-complex-state-in-react-apps-with-mobx" target="_blank" rel="noopener noreferrer">egghead.io<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 课程！</p> <h2 id="本文大纲"><a href="#本文大纲" aria-hidden="true" class="header-anchor">#</a> 本文大纲</h2> <ul><li>没有装饰器语法（@）的装饰器</li> <li>动态扩展可观察对象</li> <li>await when和flow进一步了简化异步进程</li> <li>使用onBecome(Un)Observed自动获取数据源</li> <li>专用于生产环境的更小、更快的版本</li></ul> <p>本篇博客中提到的所有新功能，在下文引用的 <a href="https://codesandbox.io/s/l73yprwj9z" target="_blank" rel="noopener noreferrer">code sandbox<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 页面中都进行了演示，请务必留意！</p> <h2 id="没有装饰器语法（-）的装饰器"><a href="#没有装饰器语法（-）的装饰器" aria-hidden="true" class="header-anchor">#</a> 没有装饰器语法（@）的装饰器</h2> <p>大多数 MobX 用户都使用了处于 Stage-2 提案阶段的装饰器语法，这种语法可以生成简单、易读的声明性代码。然而，由于该语法尚未标准化，部分用户并不乐于使用装饰器语法（不过该提案已经取得很大进展，<a href="https://github.com/tc39/proposal-decorators/blob/master/previous/METAPROGRAMMING.md#metaprogramming-with-decorators" target="_blank" rel="noopener noreferrer">很有希望<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>正式通过！）。例如，create-react-app 出于充分的理由，并不支持开箱即用的装饰器。</p> <p>MobX 4 引入了一个名为<code>decorate</code>的新 api。您可以借此使用装饰器，而且无需使用装饰器语法。直接用上代码比用文字解释更为直观，正如下例所示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> decorate<span class="token punctuation">,</span> observable<span class="token punctuation">,</span> flow <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;mobx&quot;</span>

<span class="token comment">/**
 使用装饰器语法
*/</span>
<span class="token keyword">class</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
    @observable location
    @observable temperature

    @action<span class="token punctuation">.</span>bound
    <span class="token function">fetchTemperature</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/* implementation */</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 没有使用装饰器语法
*/</span>
<span class="token keyword">class</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
    location
    temperature

    <span class="token function">fetchTemperature</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/* implementation */</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">decorate</span><span class="token punctuation">(</span>City<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    location<span class="token punctuation">:</span> observable<span class="token punctuation">,</span>
    temperature<span class="token punctuation">:</span> observable<span class="token punctuation">,</span>
    fetchTemperature<span class="token punctuation">:</span> action<span class="token punctuation">.</span>bound
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><div style="text-align:center;font-weight:bold;">现在可以不依赖于装饰器语法使用装饰器</div> <p>这样做的好处是，现在可以在 MobX API 的其他位置使用装饰器。过去，可以通过将“神奇”的封装对象，例如<code>observable.ref(some value)</code>传递给<code>observable.object</code>或<code>extendObservable</code>，从而使得特定的行为可以被附加到可观察的属性上。但是在 MobX 4中，您只需可以简单地传递一系列装饰器作为附加参数即可。</p> <p>无论是否借助装饰器语法，都可以灵活地使用装饰器的功能。实际上，这两种方式现在的唯一区别只有语法而已。新的 API 也让使用不太常见的对象扩展方法成为可能，就像<code>Object.create</code>声明原型一样来定义可观察属性。</p> <h2 id="动态扩展可观察对象"><a href="#动态扩展可观察对象" aria-hidden="true" class="header-anchor">#</a> 动态扩展可观察对象</h2> <p>MobX 4 是 MobX 5 的基石。由于在 MobX 5 中将改用使用 Proxy 来实现可观察对象和数组，并消除了由于 ES 5 的限制而引起的已知警告。因此，MobX 4 的目标是尽可能表现得像 MobX 5 一样。毫无疑问，将来人们将会有将 Mobx 的版本从 5 降级为 4 的需要，因为他们的应用程序在 Internet Explorer（不支持Proxy）之类的旧浏览器上将不能正常运行。</p> <p>出于这个原因，在 Mobx 4 中可观察对象可以是动态的集合！为了实现这一点，MobX 4 受 Vue 启发，引入了一系列工具函数以便操作集合：</p> <ul><li><code>keys(object)</code>返回对象的所有可观察属性的名称，类似于<code>Object.keys(object)</code>。</li> <li><code>values(object)</code> 返回对象的所有可观察属性的值。</li> <li><code>set(object, key, value)</code>或<code>set(object, keyValueMap)</code>将更新对象中所有指定的属性或添加新属性。</li> <li><code>remove(object, key)</code>。猜一下吧。</li> <li><code>get(object, key)</code>。返回对象中指定键下的属性值。您可能并不会经常使用它，但是此 API 的优势在于可以跟踪到尚不存在的属性值！</li> <li><code>has(object, key)</code>。返回 key 是否为可观察的属性。同样地，它将跟踪这个属性，因此您也可以借此检查尚不存在的属性。</li></ul> <p>Map 与数组都可以使用这些函数。请注意，并不是让您必须要使用这些工具函数。不过，如果您愿意使用keys或values迭代对象，并使用set动态添加属性，MobX 就能够跟踪任何将来的属性添加并做出反应。</p> <p>顺便说一句，我个人建议仍将可观察的 Map 作为动态集合使用，这样在类型上也显得更为整洁。并且它可以让其他人更清楚地明白您的数据结构的意义。</p> <p>另一个值得注意的变化是，可观察的 Map 现在由真实的 Map 支持，这意味着可观察的 Map 现在支持任意值作为键，而不仅仅是在 MobX 3 时只能由字符串或数字作为键。</p> <h2 id="改进了对异步进程的支持"><a href="#改进了对异步进程的支持" aria-hidden="true" class="header-anchor">#</a> 改进了对异步进程的支持</h2> <p>尽管可以在异步进程中直接使用，已经是 Mobx 的强项之一，MobX 4 仍然能够使一些常见的情形更加便捷。</p> <p>例如，<a href="https://github.com/mobxjs/mobx-utils" target="_blank" rel="noopener noreferrer">mobx-utils<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 包中的两个工具函数，<code>whenWithTimeout</code>而<code>whenAsync</code>现在已合并到核心 API 中。这意味着当您调用了<code>when</code>但未传入 <code>effect</code> 参数时，它将自动返回您可以的<code>await</code>的 promise 。您可以选择为此 promise 设置延时甚至<code>.cancel()</code>它！</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> when <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;mobx&quot;</span>

<span class="token keyword">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">when</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> user<span class="token punctuation">.</span>loggedOut<span class="token punctuation">)</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;You have been successfully logged out!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在<code>strict</code>模式下使用 MobX 时，具有大量回调的异步进程可能显得不够灵活，因为每个更改状态的回调都需要包装在<code>action</code>（或<code>runInAction</code>）中。为此，工具函数<code>asyncAction</code>已从 mobx-utils 包移至主包，<code>flow</code>也是在主包中导出。</p> <p><code>flow</code>在底层是使用的是生成器（generator），虽然看起来可能有点唬人，但在语义上是等效于<code>async / await</code>的，只需要将<code>async fn() {}</code>替换为<code>*fn() {}</code>、<code>await &lt;promise&gt;</code>替换为<code>yield &lt;promise&gt;</code>就可以了。下文示例中的<code>City</code>就可以很好地说明了这一点。</p> <p>使用生成器的好处是，我们可以自动将流程的每个步骤依次包装为一个动作。此外还有一些有趣的特性，比如 flow 是可取消的（只需调用返回的Promise上的<code>.cancel()</code>），而且支持形如<code>flow(async *function() { })</code>的异步生成器。</p> <p>您可以查看@leighchalliday的<a href="https://cdn.embedly.com/widgets/media.html?type=text%2Fhtml&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;schema=twitter&amp;url=https%3A//twitter.com/leighchalliday/status/972596890616377344&amp;image=https%3A//i.embed.ly/1/image%3Furl%3Dhttps%253A%252F%252Fpbs.twimg.com%252Fprofile_images%252F527868739207708672%252FquLiBx7p_400x400.jpeg%26key%3Da19fcc184b9711e1b4764040d3dc5c07" target="_blank" rel="noopener noreferrer">此视频/文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，了解有关 flow 的更多信息。</p> <p>需要注意的是，尽量地将状态的突变推迟到异步进程的最后，使应用程序在异步进程中有更少不同的状态，仍然是最佳实践。</p> <h2 id="资源管理"><a href="#资源管理" aria-hidden="true" class="header-anchor">#</a> 资源管理</h2> <p>Mobx 4 中终于引入了一些人们期待已久的钩子！例如<code>onBecomeObserved</code>和<code>onBecomeUnobserved</code>，这些钩子可用于任何可观察的集合或属性，并且可以检测到 MobX 是从何时开始或停止跟踪这些可观察对象的。例如，您可以使用此功能自动开始跟踪远程数据源，但是仅是组件需要这个值的时候才可以这样做。</p> <p>在下面的示例中，页面将自动获取一些城市的天气，并每隔几秒钟刷新一次该信息。不过，由于该演示把不同城市做了分页，因此我们只希望获取当前页面展示的城市的数据。利用这些钩子可以轻松实现这个效果。</p> <p>code sandbox 实例链接：<a href="https://codesandbox.io/s/l73yprwj9z?from-embed" target="_blank" rel="noopener noreferrer">MobX 4 demo project - CodeSandbox<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>下面的代码块是 City 类的完整定义。值得注意的是，它使用了许多 MobX 的新功能：</p> <ul><li>一个<code>flow</code>创建了一个异步的进程，来获取气象数据及处理错误。</li> <li>无需使用装饰器语法，使用<code>decorate</code>即可标记必要的字段为<code>observable</code>或<code>flow</code>。</li> <li>借助<code>onBecomeObserved</code>/ <code>onBecomeUnobserved</code>，可以使组件在开始/停止跟踪<code>temperature</code>属性时​​，立即自动恢复/暂停订阅天气 API 的数据。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> decorate<span class="token punctuation">,</span> observable<span class="token punctuation">,</span> flow<span class="token punctuation">,</span> onBecomeObserved<span class="token punctuation">,</span> onBecomeUnobserved <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> log <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./log'</span>

<span class="token keyword">const</span> <span class="token constant">APPID</span> <span class="token operator">=</span> <span class="token string">'&lt;secret&gt;'</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
    location
    temperature
    interval

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">location</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>location <span class="token operator">=</span> location
        <span class="token comment">// 仅在实际使用 temperature 属性的情况下才开始获取数据！</span>
        <span class="token function">onBecomeObserved</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'temperature'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resume<span class="token punctuation">)</span>
        <span class="token function">onBecomeUnobserved</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'temperature'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>suspend<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function-variable function">resume</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Resuming </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>location<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>interval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchTemperature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token number">5000</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function-variable function">suspend</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Suspending </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>location<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>temperature <span class="token operator">=</span> <span class="token keyword">undefined</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>interval<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 一个异步的 flow</span>
    <span class="token comment">// 请注意，它的工作方式类似于async / await，但语法不同</span>
    fetchTemperature <span class="token operator">=</span> <span class="token function">flow</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">yield</span> window<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.openweathermap.org/data/2.5/weather?appid=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">APPID</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;q=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>location<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">)</span>
        <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">yield</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>temperature <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>main<span class="token punctuation">.</span>temp <span class="token operator">-</span> <span class="token number">273.15</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Temperature in </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>location<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>temperature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Failed to fetch temperature: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 使用装饰器的功能但不使用装饰器语法</span>
<span class="token function">decorate</span><span class="token punctuation">(</span>City<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    location<span class="token punctuation">:</span> observable<span class="token punctuation">,</span>
    temperature<span class="token punctuation">:</span> observable
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p>如下面的代码所示，凭借着这些新功能，我们的<code>CityView</code>组件甚至不需要去感知所需的数据获取，因此看起来显得非常小，已经无需增加任何其他逻辑！有一点需要注意的是，如果直接将<code>city.temperature</code>从该组件中删除，将会导致<code>City</code>类变得完全无法开始获取数据🎉。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> CityView <span class="token operator">=</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> city <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
        City<span class="token punctuation">:</span> <span class="token punctuation">{</span>city<span class="token punctuation">.</span>location<span class="token punctuation">}</span> <span class="token operator">-</span> Temperature <span class="token keyword">in</span> ℃<span class="token punctuation">:</span> <span class="token punctuation">{</span>city<span class="token punctuation">.</span>temperature <span class="token operator">||</span> <span class="token string">'Loading'</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="更快捷、轻便"><a href="#更快捷、轻便" aria-hidden="true" class="header-anchor">#</a> 更快捷、轻便</h2> <p>MobX 4 针对生产环境与开发环境推出了单独的版本。通过去除大量的一致性和 API 使用检查，可以使得用于生产环境的 MobX 更小、更快。可以通过引用 CDN 的<code>.min.js</code>版本来生产版本，或者是取消<code>process.env.NODE_ENV与&quot;production&quot;</code>之间的绑定。这与 React 所使用的机制完全相同，因此，如果您的 React 构建已经正确设置，则无需再进行任何其他操作！</p> <p>不管怎样，下面的一些统计数据可以作为参考：</p> <ul><li>MobX 4 与 MobX 3 相比，测试套件性能提高了14％。</li> <li>压缩后的最小构建大小从 17.3kB 降至 14.2kB（缩小了22％）。而且，由于 MobX 4 可以更好地进行 tree-shaking，因此实际上可以将体积压缩的甚至更小。</li></ul> <h2 id="更多"><a href="#更多" aria-hidden="true" class="header-anchor">#</a> 更多</h2> <p>虽然上面所提到的新功能并非所有的更新内容，但也是其中最有趣的部分。可以通过请查阅完整的<a href="https://github.com/mobxjs/mobx/blob/master/CHANGELOG.md#400" target="_blank" rel="noopener noreferrer">变更日志<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>了解其他遗珠。</p><div style="text-align:center;"><img src="https://s1.ax1x.com/2020/05/28/te6WX4.png" alt="在做重大改动需要集中精力"></div> <div style="text-align:center;font-weight:bold;">在做重大改动时需要集中精力:) monkeyuser.com
</div><p></p> <p>MobX 是一个开源项目。凭借着 <a href="https://www.mendix.com/careers/" target="_blank" rel="noopener noreferrer">Mendix<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 对 MobX 维护非常慷慨地鼎力相助，实际上我只花了几个星期的时间来开发 MobX 4 和 5（希望能在几周内完成）。可以顺利开发完成主要原因是，我能够心无旁骛地专注于在 MobX 的工作，从而去实现一些重大改动！</p> <p>因此，如果 MobX 在过去为您节省了大量的精力，并因此节省了金钱。请考虑赞助它的发展！谢谢！🍻</p> <ul><li><a href="https://opencollective.com/mobx" target="_blank" rel="noopener noreferrer">MobX 的 open collective<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.patreon.com/mweststrate" target="_blank" rel="noopener noreferrer">Patreon<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.paypal.me/michelweststrate" target="_blank" rel="noopener noreferrer">Paypal<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（是的，Marinus Cornelis是我的真实姓名🎃）</li></ul></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">5/31/2020, 3:25:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/2009/20200919A.html" class="prev">
          【归纳】代码优化技巧与可读性
        </a></span> <span class="next"><a href="/2005/20200531A.html">
          【翻译】从 Mobx 3 迁移到 Mobx 4
        </a>
        →
      </span></p></div> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.20586f85.js" defer></script><script src="/assets/js/3.a975d71c.js" defer></script><script src="/assets/js/1.f9715dde.js" defer></script><script src="/assets/js/116.80cf31f3.js" defer></script>
  </body>
</html>
