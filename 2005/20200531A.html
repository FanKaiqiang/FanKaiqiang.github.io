<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ã€ç¿»è¯‘ã€‘ä» Mobx 3 è¿ç§»åˆ° Mobx 4 | Franko&#39;s Blog</title>
    <meta name="description" content="é•¿æ±Ÿä¸€å¸†è¿œï¼Œè½æ—¥äº”æ¹–æ˜¥ã€‚">
    <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.82618647.css" as="style"><link rel="preload" href="/assets/js/app.20586f85.js" as="script"><link rel="preload" href="/assets/js/3.a975d71c.js" as="script"><link rel="preload" href="/assets/js/1.f9715dde.js" as="script"><link rel="preload" href="/assets/js/117.2b92a260.js" as="script"><link rel="prefetch" href="/assets/js/10.3713fa2b.js"><link rel="prefetch" href="/assets/js/100.c7e8673f.js"><link rel="prefetch" href="/assets/js/101.29a59833.js"><link rel="prefetch" href="/assets/js/102.3fbd0f95.js"><link rel="prefetch" href="/assets/js/103.72c6e9b5.js"><link rel="prefetch" href="/assets/js/104.f6f27012.js"><link rel="prefetch" href="/assets/js/105.0d66958f.js"><link rel="prefetch" href="/assets/js/106.290db28e.js"><link rel="prefetch" href="/assets/js/107.e20e3803.js"><link rel="prefetch" href="/assets/js/108.cd45cee0.js"><link rel="prefetch" href="/assets/js/109.4ba3d58f.js"><link rel="prefetch" href="/assets/js/11.3f5de7ee.js"><link rel="prefetch" href="/assets/js/110.0d55c579.js"><link rel="prefetch" href="/assets/js/111.3648d92a.js"><link rel="prefetch" href="/assets/js/112.cf39ecb8.js"><link rel="prefetch" href="/assets/js/113.6f2fdbc4.js"><link rel="prefetch" href="/assets/js/114.77c92b08.js"><link rel="prefetch" href="/assets/js/115.0656b5e6.js"><link rel="prefetch" href="/assets/js/116.80cf31f3.js"><link rel="prefetch" href="/assets/js/118.c06968f3.js"><link rel="prefetch" href="/assets/js/119.20ab4e08.js"><link rel="prefetch" href="/assets/js/12.19e53560.js"><link rel="prefetch" href="/assets/js/120.97d79ae7.js"><link rel="prefetch" href="/assets/js/121.f6da62ca.js"><link rel="prefetch" href="/assets/js/122.859caf01.js"><link rel="prefetch" href="/assets/js/13.dda8f215.js"><link rel="prefetch" href="/assets/js/14.2a592289.js"><link rel="prefetch" href="/assets/js/15.4925e3a4.js"><link rel="prefetch" href="/assets/js/16.0f840892.js"><link rel="prefetch" href="/assets/js/17.3e801416.js"><link rel="prefetch" href="/assets/js/18.b4d3a92e.js"><link rel="prefetch" href="/assets/js/19.f9cee7a0.js"><link rel="prefetch" href="/assets/js/20.3f33780e.js"><link rel="prefetch" href="/assets/js/21.ed566f24.js"><link rel="prefetch" href="/assets/js/22.94f8e887.js"><link rel="prefetch" href="/assets/js/23.fb38ed6e.js"><link rel="prefetch" href="/assets/js/24.dd36a8c2.js"><link rel="prefetch" href="/assets/js/25.bb6cacf5.js"><link rel="prefetch" href="/assets/js/26.c86a26fa.js"><link rel="prefetch" href="/assets/js/27.2dd1516a.js"><link rel="prefetch" href="/assets/js/28.83a01027.js"><link rel="prefetch" href="/assets/js/29.fcd25cd4.js"><link rel="prefetch" href="/assets/js/30.a1c1c82d.js"><link rel="prefetch" href="/assets/js/31.274c9b5e.js"><link rel="prefetch" href="/assets/js/32.f75d4ae9.js"><link rel="prefetch" href="/assets/js/33.1e4d92da.js"><link rel="prefetch" href="/assets/js/34.4ef7ac99.js"><link rel="prefetch" href="/assets/js/35.4f47ea1f.js"><link rel="prefetch" href="/assets/js/36.f1911a7c.js"><link rel="prefetch" href="/assets/js/37.b562ea4c.js"><link rel="prefetch" href="/assets/js/38.b862a71d.js"><link rel="prefetch" href="/assets/js/39.0a74782b.js"><link rel="prefetch" href="/assets/js/4.46f5c0e2.js"><link rel="prefetch" href="/assets/js/40.f75bdd02.js"><link rel="prefetch" href="/assets/js/41.62a05ca3.js"><link rel="prefetch" href="/assets/js/42.1a733cf6.js"><link rel="prefetch" href="/assets/js/43.7506e026.js"><link rel="prefetch" href="/assets/js/44.568d2265.js"><link rel="prefetch" href="/assets/js/45.50e5cd0c.js"><link rel="prefetch" href="/assets/js/46.2c3c32c9.js"><link rel="prefetch" href="/assets/js/47.f9a54e6b.js"><link rel="prefetch" href="/assets/js/48.32da44eb.js"><link rel="prefetch" href="/assets/js/49.df6b0b62.js"><link rel="prefetch" href="/assets/js/5.bb6aabf2.js"><link rel="prefetch" href="/assets/js/50.52d40ed6.js"><link rel="prefetch" href="/assets/js/51.e7a7badb.js"><link rel="prefetch" href="/assets/js/52.6a20c4e8.js"><link rel="prefetch" href="/assets/js/53.2747af5b.js"><link rel="prefetch" href="/assets/js/54.02396d0d.js"><link rel="prefetch" href="/assets/js/55.7b929339.js"><link rel="prefetch" href="/assets/js/56.f24df74e.js"><link rel="prefetch" href="/assets/js/57.a39d5e97.js"><link rel="prefetch" href="/assets/js/58.b13862f5.js"><link rel="prefetch" href="/assets/js/59.b2ef3cb1.js"><link rel="prefetch" href="/assets/js/6.9a323443.js"><link rel="prefetch" href="/assets/js/60.3b294663.js"><link rel="prefetch" href="/assets/js/61.23d3575f.js"><link rel="prefetch" href="/assets/js/62.9c1cd3c8.js"><link rel="prefetch" href="/assets/js/63.4376c00d.js"><link rel="prefetch" href="/assets/js/64.59741dd5.js"><link rel="prefetch" href="/assets/js/65.8e59eee4.js"><link rel="prefetch" href="/assets/js/66.a07156ca.js"><link rel="prefetch" href="/assets/js/67.bad8de6a.js"><link rel="prefetch" href="/assets/js/68.348f3c6f.js"><link rel="prefetch" href="/assets/js/69.27403668.js"><link rel="prefetch" href="/assets/js/7.7376f609.js"><link rel="prefetch" href="/assets/js/70.e105d08d.js"><link rel="prefetch" href="/assets/js/71.3912c588.js"><link rel="prefetch" href="/assets/js/72.2e803182.js"><link rel="prefetch" href="/assets/js/73.698bb062.js"><link rel="prefetch" href="/assets/js/74.6eb02d59.js"><link rel="prefetch" href="/assets/js/75.5e85377b.js"><link rel="prefetch" href="/assets/js/76.a50ad35f.js"><link rel="prefetch" href="/assets/js/77.9923eba2.js"><link rel="prefetch" href="/assets/js/78.30d80868.js"><link rel="prefetch" href="/assets/js/79.b0633c2f.js"><link rel="prefetch" href="/assets/js/8.effb8ee5.js"><link rel="prefetch" href="/assets/js/80.1c7129b4.js"><link rel="prefetch" href="/assets/js/81.757e25f5.js"><link rel="prefetch" href="/assets/js/82.04a6c134.js"><link rel="prefetch" href="/assets/js/83.a5425512.js"><link rel="prefetch" href="/assets/js/84.478c64ab.js"><link rel="prefetch" href="/assets/js/85.e304024e.js"><link rel="prefetch" href="/assets/js/86.46d38efd.js"><link rel="prefetch" href="/assets/js/87.8ab01c2a.js"><link rel="prefetch" href="/assets/js/88.695a06d9.js"><link rel="prefetch" href="/assets/js/89.2b9afe77.js"><link rel="prefetch" href="/assets/js/9.a3297750.js"><link rel="prefetch" href="/assets/js/90.6dd7f214.js"><link rel="prefetch" href="/assets/js/91.891f6634.js"><link rel="prefetch" href="/assets/js/92.32bd7ffa.js"><link rel="prefetch" href="/assets/js/93.646030b0.js"><link rel="prefetch" href="/assets/js/94.2df43ae3.js"><link rel="prefetch" href="/assets/js/95.ca4e89a0.js"><link rel="prefetch" href="/assets/js/96.4b4fcf2a.js"><link rel="prefetch" href="/assets/js/97.705f40c5.js"><link rel="prefetch" href="/assets/js/98.3035542d.js"><link rel="prefetch" href="/assets/js/99.40877126.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82618647.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Franko's Blog</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  å…³äºæˆ‘
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  æ—¶é—´è½´
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/ç¬”è®°.html" class="nav-link"><i class="iconfont undefined"></i>
  ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/category/éšç¬”.html" class="nav-link"><i class="iconfont undefined"></i>
  éšç¬”
</a></li><li class="dropdown-item"><!----> <a href="/category/é¡¹ç›®æ€»ç»“.html" class="nav-link"><i class="iconfont undefined"></i>
  é¡¹ç›®æ€»ç»“
</a></li><li class="dropdown-item"><!----> <a href="/category/è¯»ä¹¦è®°å½•.html" class="nav-link"><i class="iconfont undefined"></i>
  è¯»ä¹¦è®°å½•
</a></li><li class="dropdown-item"><!----> <a href="/category/ç¿»è¯‘.html" class="nav-link"><i class="iconfont undefined"></i>
  ç¿»è¯‘
</a></li><li class="dropdown-item"><!----> <a href="/category/å…³äºæˆ‘.html" class="nav-link"><i class="iconfont undefined"></i>
  å…³äºæˆ‘
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  æºç 
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/aboutMe.html" class="nav-link"><i class="iconfont reco-account"></i>
  å…³äºæˆ‘
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  æ—¶é—´è½´
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/ç¬”è®°.html" class="nav-link"><i class="iconfont undefined"></i>
  ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/category/éšç¬”.html" class="nav-link"><i class="iconfont undefined"></i>
  éšç¬”
</a></li><li class="dropdown-item"><!----> <a href="/category/é¡¹ç›®æ€»ç»“.html" class="nav-link"><i class="iconfont undefined"></i>
  é¡¹ç›®æ€»ç»“
</a></li><li class="dropdown-item"><!----> <a href="/category/è¯»ä¹¦è®°å½•.html" class="nav-link"><i class="iconfont undefined"></i>
  è¯»ä¹¦è®°å½•
</a></li><li class="dropdown-item"><!----> <a href="/category/ç¿»è¯‘.html" class="nav-link"><i class="iconfont undefined"></i>
  ç¿»è¯‘
</a></li><li class="dropdown-item"><!----> <a href="/category/å…³äºæˆ‘.html" class="nav-link"><i class="iconfont undefined"></i>
  å…³äºæˆ‘
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/FanKaiqiang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  æºç 
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>2020</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ä¹æœˆ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>äº”æœˆ</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2005/20200528A.html" class="sidebar-link">ã€ç¿»è¯‘ã€‘MobX 4ï¼šæ›´ä¼˜ç§€ã€ç®€æ˜“ã€å¿«æ·ã€è½»ä¾¿</a></li><li><a href="/2005/20200531A.html" class="active sidebar-link">ã€ç¿»è¯‘ã€‘ä» Mobx 3 è¿ç§»åˆ° Mobx 4</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/2005/20200531A.html#å˜æ›´æ¦‚è¿°" class="sidebar-link">å˜æ›´æ¦‚è¿°</a></li><li class="sidebar-sub-header"><a href="/2005/20200531A.html#å·²åˆ é™¤çš„å†…å®¹" class="sidebar-link">å·²åˆ é™¤çš„å†…å®¹</a></li><li class="sidebar-sub-header"><a href="/2005/20200531A.html#å·²è¿ç§»çš„å†…å®¹" class="sidebar-link">å·²è¿ç§»çš„å†…å®¹</a></li><li class="sidebar-sub-header"><a href="/2005/20200531A.html#å‘ç”Ÿæ”¹å˜çš„å†…å®¹" class="sidebar-link">å‘ç”Ÿæ”¹å˜çš„å†…å®¹</a></li><li class="sidebar-sub-header"><a href="/2005/20200531A.html#å…¶ä»–æ”¹åŠ¨" class="sidebar-link">å…¶ä»–æ”¹åŠ¨</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>å››æœˆ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ä¸‰æœˆ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>äºŒæœˆ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ä¸€æœˆ</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2019</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2018</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>ã€ç¿»è¯‘ã€‘ä» Mobx 3 è¿ç§»åˆ° Mobx 4</h1> <hr> <div data-v-b53d65a4><i class="iconfont reco-account" data-v-b53d65a4><span data-v-b53d65a4>å¹¿å®‡</span></i> <i class="iconfont reco-date" data-v-b53d65a4><span data-v-b53d65a4>2020-5-31</span></i> <!----> <i class="iconfont reco-tag tags" data-v-b53d65a4><span class="tag-item" data-v-b53d65a4>
      Mobx
    </span></i></div></div> <div class="content__default"><div class="tip custom-block"><p>ä»Šå¤©æ˜¯äº”æœˆæœ€åä¸€å¤©äº†ï¼Œå‘¨å…­ä¼‘æ¯äº†ä¸€å¤©æ„Ÿè§‰ç¥æ¸…æ°”çˆ½ã€‚è™½ç„¶å…¶å®ä¼‘æ¯ä¹Ÿæ²¡æ€ä¹ˆä¼‘æ¯å°±æ˜¯äº†ï¼Œåˆç¡ä¹Ÿæ²¡æœ‰ç¡ï¼Œå› ä¸ºå‡†å¤‡ç§Ÿæˆ¿äº†è¿˜å»å’Œæ€»ç»“çœ‹æ¥ä¸¤å¥—æˆ¿ã€‚ä½†æ˜¯åªè¦æ²¡æœ‰åœ¨ä¸Šç­å°±æ„Ÿè§‰å¾ˆçˆ½ã€‚è¶ç°åœ¨è¿˜æœ‰ç©ºå°±æŠŠè¿˜æ˜¯ä¹‹å‰ç¿»è¯‘çš„ä¸€ç¯‡ Mobx å‡çº§ç›¸å…³çš„æ–‡ç« æ¬è¿è¿‡æ¥ï¼Œå……å®ä¸€ä¸‹è¿™ä¸ªæœˆçš„åšå®¢æ•°é‡å§ã€‚</p></div> <p>è¿™ç¯‡æ–‡ç« æ˜¯ Mobx ä½œè€…å†™çš„ä¸€ç¯‡å…³äº Mobx 3 å‡çº§åˆ° Mobx 4 çš„è¿ç§»æŒ‡å—ã€‚</p><div style="text-align:center;"><img src="https://s1.ax1x.com/2020/05/31/t1kWMF.jpg" alt="å°é¢"></div><p></p> <blockquote><p>ç¿»è¯‘åŸæ–‡ï¼š<a href="https://github.com/mobxjs/mobx/wiki/Migrating-from-mobx-3-to-mobx-4" target="_blank" rel="noopener noreferrer">Migrating from mobx 3 to mobx 4 Â· mobxjs/mobx Wiki<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h2 id="å˜æ›´æ¦‚è¿°"><a href="#å˜æ›´æ¦‚è¿°" aria-hidden="true" class="header-anchor">#</a> å˜æ›´æ¦‚è¿°</h2> <p>éå¸¸æŠ±æ­‰ï¼Œæœ¬è¿ç§»æŒ‡å—çœ‹èµ·æ¥å¦‚æ­¤çš„åˆå¤§åˆé•¿ ğŸ˜ƒï¼Œä¸è¿‡å¥½æ¶ˆæ¯æ˜¯ï¼Œå¯èƒ½æ‚¨ä»æœªå¬è¯´è¿‡æœ¬æŒ‡å—ä¸­æåˆ°çš„å¤§å¤šæ•°å˜æ›´ã€‚ä½†æ˜¯ä½œä¸ºæŒ‡å—æ˜¯éœ€è¦æ— æ‡ˆå¯å‡»çš„ï¼Œéœ€è¦å°†å®ƒä»¬å…¨éƒ¨åˆ—å‡ºã€‚MobX 4 å°†ä¼šåœ¨è¿è¡Œæ—¶æ£€æµ‹åˆ°å¤§éƒ¨åˆ†é”™è¯¯çš„/å·²å¼ƒç”¨çš„ api çš„ä½¿ç”¨æƒ…å†µï¼Œå› æ­¤è¿ç§»çš„æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å…ˆå‡çº§ï¼Œå†æ ¹æ®æœ¬æŒ‡å—ä¿®å¤é”™è¯¯ã€‚å¦‚æœæ‚¨åœ¨é¡¹ç›®ä¸­å¯ç”¨äº†TypeScriptï¼ˆæˆ–Flowï¼‰ï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘æ—¶å°±ä¼šæ ‡è®°å‡ºæ¥å¤§å¤šæ•°ä¸èµæˆä½¿ç”¨çš„ apiã€‚</p> <p>MobX 4 åˆ é™¤äº†æ—©åœ¨ MobX 3 ä¸­å°±å·²ç»å¼ƒç”¨äº†çš„æ‰€æœ‰ apiã€‚å› æ­¤ï¼Œè¯·ç¡®ä¿åœ¨å‡çº§ä¹‹å‰æ²¡æœ‰ä»»ä½•å¼ƒç”¨è­¦å‘Š: )ã€‚</p> <p><code>extras</code>å‘½åç©ºé—´è¢«åˆ é™¤äº†ï¼Œå…¶ä¸­åŒ…å«çš„æ‰€æœ‰çš„æ–¹æ³•ç°åœ¨éƒ½åœ¨åŒ…é¡¶å±‚å…¬å¼€å‡ºæ¥ã€‚è¿™æ ·å¯ä»¥ä½¿å¾— rollup æˆ– Webpack ç­‰å·¥å…·å¯ä»¥æ›´å¥½åœ°è¿›è¡Œ tree-shakingã€‚</p> <p>MobX 4 é’ˆå¯¹ç”Ÿäº§ç¯å¢ƒä¸å¼€å‘ç¯å¢ƒæ¨å‡ºäº†å•ç‹¬çš„ç‰ˆæœ¬ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å°†å–æ¶ˆå¤§å¤šæ•°ç±»å‹æ£€æŸ¥ï¼Œä»¥ç”Ÿæˆè¿è¡Œæ›´å¿«ï¼Œä½“ç§¯æ›´å°çš„ç‰ˆæœ¬ã€‚å› æ­¤è¯·ç¡®ä¿åœ¨æ‚¨çš„æ„å»ºè¿‡ç¨‹ä¸­ä¸åš<code>process.env.NODE_ENV = &quot;production&quot;</code>çš„è®¾ç½®ï¼å¦‚æœæ‚¨æ˜¯åœ¨ Reacté¡¹ç›®ä¸­ä½¿ç”¨ MobX çš„è¯ï¼Œå°±å¯èƒ½å·²ç»åšå¥½äº†æ­£ç¡®çš„é…ç½®ã€‚ç›¸å…³æ–‡æ¡£ï¼š<a href="https://zh-hans.reactjs.org/docs/add-react-to-a-website.html" target="_blank" rel="noopener noreferrer">åœ¨ç½‘ç«™ä¸­æ·»åŠ  React â€“ React<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <p><code>observable.*</code> api å˜å¾—æ›´åŠ ç®€åŒ–ã€ä¸€è‡´ã€‚æ­¤å¤–ï¼Œç°åœ¨å¯ä»¥åœ¨å¯ç”¨å’Œç¦ç”¨è£…é¥°å™¨è¯­æ³•çš„æƒ…å†µä¸‹ä½¿ç”¨è£…é¥°å™¨ã€‚80ï¼…åˆ°90ï¼…çš„ api å°†ä¸ MobX 3 ä¿æŒä¸€è‡´ï¼Œä½†æ˜¯æ‚¨è¿˜æ˜¯éœ€è¦å¯¹äºæŸäº›è¾¹ç•Œæƒ…å†µåšå‡ºä¸€äº›è°ƒæ•´ã€‚</p> <p>å¤§å¤šæ•° api å‡å·²ç®€åŒ–ã€‚ä¾‹å¦‚ï¼Œåœ¨ä»¥å¾€è®¸å¤š api å°†ä¼šæŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸º <code>name</code>ï¼Œå…¶ä»–é¢å¤–çš„æŒ‡æ ‡ä½œä¸ºåç»­çš„å‚æ•°ã€‚è€Œç°åœ¨å‡ ä¹æ‰€æœ‰çš„ api éƒ½å·²ç»æ”¹ä¸ºå°†å¿…éœ€çš„å‚æ•°ä¼˜å…ˆä¼ å…¥ï¼Œè€Œåæ‰æ˜¯ä½œä¸ºå¯é€‰é…ç½®çš„å¯¹è±¡ã€‚api å˜å¾—æ›´ç®€å•æ˜“è¯»äº†ã€‚</p> <p>å¯¹äº TypeScript ç”¨æˆ·ï¼Œåœ¨configä¸­åº”å°†<code>tslib</code>è®¾ç½®ä¸º<code>es6</code>ï¼ˆç¼–è¯‘çš„ç›®æ ‡ä»å¯ä»¥ä¸ºES5ï¼‰ã€‚</p> <h2 id="å·²åˆ é™¤çš„å†…å®¹"><a href="#å·²åˆ é™¤çš„å†…å®¹" aria-hidden="true" class="header-anchor">#</a> å·²åˆ é™¤çš„å†…å®¹</h2> <p><em>æ³¨æ„ï¼šä¸ºäº†ä½¿  api çš„ä½“ç§¯æ›´å°ï¼Œåˆ é™¤äº†è®¸å¤šå·²ä¸å‡†å¤‡æ”¯æŒçš„åŠŸèƒ½ã€‚å¦‚æœæ‚¨è®¤ä¸ºä¸åº”åˆ é™¤æŸäº›åŠŸèƒ½ï¼Œè¯·éšæ—¶æå‡º issueï¼</em></p> <p><code>shareGlobalState</code>å·²è¢«åˆ é™¤ã€‚ç°æœ‰çš„æ–¹æ³•å·²ç»è¶³ä»¥æ­£ç¡®åœ°è®¾ç½®é¡¹ç›® MobX å…±äº«: )ã€‚</p> <p><code>autorun</code>ï¼Œ<code>reaction</code>ï¼Œ<code>runInAction</code>ç­‰æ–¹æ³•ä¸å†æ”¯æŒæ¥å—<code>context</code> å‚æ•°ï¼ˆ<code>this</code>ï¼‰ã€‚è¯·æ”¹ç”¨ç®­å¤´å‡½æ•°ä»£æ›¿ã€‚</p> <p><code>isModifierDescriptor</code>ã€<code>isStrictModeEnabled</code>ã€<code>extras.spyReport</code>ã€<code>extras.spyReportEnd</code>ã€<code>extras.spyReportStart</code>ã€<code>extras.isSpyEnabled</code>ç­‰æ–¹æ³•å°†ä¸å¤å­˜åœ¨ã€‚</p> <p><code>whyRun</code>å·²è¢«åˆ é™¤ï¼Œè¯·æ”¹ç”¨æ›´ç®€æ´çš„ <a href="https://cn.mobx.js.org/best/trace.html" target="_blank" rel="noopener noreferrer">trace<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ–¹æ³•ã€‚</p> <p>mobx çš„ <code>default</code> å¯¼å‡ºå°†ä¸å†å…¬å¼€ã€‚è¿™æ„å‘³ç€æ‚¨ä¸èƒ½å†é€šè¿‡<code>import mobx from &quot;mobx&quot;</code>çš„æ–¹å¼å¼•å…¥ mobxï¼Œè€Œæ˜¯æ˜¾å¼åœ°å¯¼å…¥å†…å®¹ï¼š<code>import { observable } from &quot;mobx&quot;</code>ã€‚ï¼ˆæˆ–ä½¿ç”¨<code>import * as mobx from &quot;mobx&quot;</code>å¹¶ç»ˆæ­¢ tree-shakingï¼‰ã€‚</p> <h2 id="å·²è¿ç§»çš„å†…å®¹"><a href="#å·²è¿ç§»çš„å†…å®¹" aria-hidden="true" class="header-anchor">#</a> å·²è¿ç§»çš„å†…å®¹</h2> <p>è®¸å¤šæ–¹æ³•å·²ç»ä»<code>extras</code>å‘½åç©ºé—´ä¸­è½¬ç§»äº†ã€‚ä¸‹åˆ— api ä¸­ï¼Œå¸¦æœ‰_å‰ç¼€çš„ä»ç„¶æ˜¯éå®˜æ–¹çš„apiï¼ˆä½†å¯ä»¥ç”¨äºæµ‹è¯•ï¼‰ï¼Œæ— å‰ç¼€çš„æ–¹æ³•ç°å·²æ­£å¼æ”¯æŒã€‚</p> <table><thead><tr><th style="text-align:center;">æ—§API</th> <th style="text-align:center;">æ–°API</th></tr></thead> <tbody><tr><td style="text-align:center;"><code>useStrict(boolean)</code></td> <td style="text-align:center;"><code>configure({ enforceActions: boolean })</code></td></tr> <tr><td style="text-align:center;"><code>expr</code></td> <td style="text-align:center;">ç°åœ¨æ˜¯<code>mobx-utils</code>åŒ…çš„ä¸€éƒ¨åˆ†</td></tr> <tr><td style="text-align:center;"><code>createTransformer</code></td> <td style="text-align:center;">ç°åœ¨æ˜¯<code>mobx-utils</code>åŒ…çš„ä¸€éƒ¨åˆ†</td></tr> <tr><td style="text-align:center;"><code>map(values)</code></td> <td style="text-align:center;"><code>observable.map(values)</code></td></tr> <tr><td style="text-align:center;"><code>extras.allowStateChanges</code></td> <td style="text-align:center;"><code>_allowStateChanges</code></td></tr> <tr><td style="text-align:center;"><code>extras.deepEqual</code></td> <td style="text-align:center;"><code>comparer.structural</code></td></tr> <tr><td style="text-align:center;"><code>extras.getAdministration</code></td> <td style="text-align:center;"><code>getAdministration</code></td></tr> <tr><td style="text-align:center;"><code>extras.getAtom</code></td> <td style="text-align:center;"><code>getAtom</code></td></tr> <tr><td style="text-align:center;"><code>extras.getDebugName</code></td> <td style="text-align:center;"><code>getDebugName</code></td></tr> <tr><td style="text-align:center;"><code>extras.getDependencyTree</code></td> <td style="text-align:center;"><code>getDependencyTree</code></td></tr> <tr><td style="text-align:center;"><code>extras.getGlobalState</code></td> <td style="text-align:center;"><code>_getGlobalState</code></td></tr> <tr><td style="text-align:center;"><code>extras.getObserverTree</code></td> <td style="text-align:center;"><code>getObserverTree</code></td></tr> <tr><td style="text-align:center;"><code>extras.interceptReads</code></td> <td style="text-align:center;"><code>_interceptReads</code></td></tr> <tr><td style="text-align:center;"><code>extras.isComputingDerivation</code></td> <td style="text-align:center;"><code>_isComputingDerivation</code></td></tr> <tr><td style="text-align:center;"><code>extras.isolateGlobalState()</code></td> <td style="text-align:center;"><code>configure({ isolateGlobalState: true })</code></td></tr> <tr><td style="text-align:center;"><code>extras.onReactionError</code></td> <td style="text-align:center;"><code>onReactionError</code></td></tr> <tr><td style="text-align:center;"><code>extras.reserveArrayBuffer(number)</code></td> <td style="text-align:center;"><code>configure({ arrayBuffer: number })</code></td></tr> <tr><td style="text-align:center;"><code>extras.resetGlobalState</code></td> <td style="text-align:center;"><code>_resetGlobalState</code></td></tr> <tr><td style="text-align:center;"><code>extras.setReactionScheduler(fn)</code></td> <td style="text-align:center;"><code>configure({ reactionScheduler : fn })</code></td></tr></tbody></table> <h2 id="å‘ç”Ÿæ”¹å˜çš„å†…å®¹"><a href="#å‘ç”Ÿæ”¹å˜çš„å†…å®¹" aria-hidden="true" class="header-anchor">#</a> å‘ç”Ÿæ”¹å˜çš„å†…å®¹</h2> <h3 id="ä¸ä½¿ç”¨è£…é¥°å™¨è¯­æ³•ï¼ˆ-ï¼‰çš„è£…é¥°å™¨"><a href="#ä¸ä½¿ç”¨è£…é¥°å™¨è¯­æ³•ï¼ˆ-ï¼‰çš„è£…é¥°å™¨" aria-hidden="true" class="header-anchor">#</a> ä¸ä½¿ç”¨è£…é¥°å™¨è¯­æ³•ï¼ˆ@ï¼‰çš„è£…é¥°å™¨</h3> <p><code>observable.ref</code>ï¼Œ<code>observable.shallow</code>ï¼Œ<code>observable.deep</code>ï¼Œ<code>observable.struct</code>ç­‰è£…é¥°å™¨æ–¹æ³•ä¸å†è¢«ç”¨ä½œä¸ºå‡½æ•°ä½¿ç”¨ï¼Œè€Œæ˜¯é€šè¿‡å§‹ç»ˆç”¨è£…é¥°å™¨çš„æ–¹å¼ä½¿ç”¨è¿™äº› apiï¼Œä»¤å…¶æ›´åŠ ä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œ<code>observable.object</code>å’Œ<code>extendObservable</code>ç°åœ¨æ”¯æŒä¸€ä¸ª<code>decorators</code>å‚æ•°ç”¨äºæ¥å—è£…é¥°å™¨ã€‚</p> <p>å…¶ä¸­ Mobx 3 ä¸­çš„è£…é¥°å™¨æ–¹æ³•ï¼Œåœ¨ Mobx 4 åº”è¯¥æ”¹ä¸ºä½¿ç”¨ decorators å‚æ•°ã€‚ä¾‹å¦‚ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// MobX 3</span>
<span class="token keyword">const</span> myObject <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;Michel&quot;</span><span class="token punctuation">,</span>
  profile<span class="token punctuation">:</span> observable<span class="token punctuation">.</span><span class="token function">ref</span><span class="token punctuation">(</span>someDataFetchingPromise<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// MobX 4</span>
<span class="token keyword">const</span> myObject <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;Michel&quot;</span><span class="token punctuation">,</span>
  profile<span class="token punctuation">:</span> someDataFetchingPromise
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// æŒ‡å®šè£…é¥°å™¨.ã€‚é»˜è®¤å€¼ä¸º'observable'ï¼Œå› æ­¤æˆ‘ä»¬åªæŒ‡å®šäº†'profile':</span>
  profile<span class="token punctuation">:</span> observable<span class="token punctuation">.</span>ref   <span class="token comment">// æ³¨æ„ï¼šä¸è¦åŠ  () !</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ï¼Œç°åœ¨ä½¿ç”¨<code>@decorator</code>ä¸<code>decorator</code>çš„æ•ˆæœä¸€è‡´çš„ï¼Œä¸¤ç§æ–¹å¼è°ƒç”¨æ–¹å¼å’Œæ¥æ”¶å‚æ•°å§‹ç»ˆç›¸åŒã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„å‡ ä¸ªç¤ºä¾‹éƒ½å®ç°äº†ç›¸åŒçš„æ•ˆæœã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåˆ‡æ¢ä¸åŒçš„è¯­æ³•æˆ–åˆ›å»ºå¯¹è±¡çš„æ–¹å¼æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Todo</span> <span class="token punctuation">{</span>
    @observable title <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span>
    @observable<span class="token punctuation">.</span>ref promise <span class="token operator">=</span> somePromise

    @computed <span class="token keyword">get</span> <span class="token function">difficulty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">.</span>length
    <span class="token punctuation">}</span>
    @<span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{</span> requiresReaction<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">get</span> <span class="token function">expensive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">somethingExpensive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    @action <span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> t
    <span class="token punctuation">}</span>
    @action<span class="token punctuation">.</span>bound <span class="token function">setTitle2</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> t
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// observable.object ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•° 'decorators'ï¼ŒæŒ‡å®šéœ€è¦ä½¿ç”¨çš„è£…é¥°å™¨ã€‚</span>
<span class="token comment">// å¯¹äºçœç•¥çš„å±æ€§ï¼Œé»˜è®¤ä¸º `observable` (getters å±æ€§é»˜è®¤ä¸º`computed`)</span>
<span class="token keyword">const</span> todo <span class="token operator">=</span> observable<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
    promise<span class="token punctuation">:</span> somePromise<span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">difficulty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">.</span>length
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">expensive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">somethingExpensive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> t
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setTitle2</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> t
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// title: observable å¯ä»¥çœç•¥ï¼Œå½“ observable.object / extendobservable æ—¶å…¶å°†ä½œä¸ºé»˜è®¤å€¼ã€‚</span>
    ref<span class="token punctuation">:</span> observable<span class="token punctuation">.</span>ref<span class="token punctuation">,</span>
    expensive<span class="token punctuation">:</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{</span> requiresReaction<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    setTitle<span class="token punctuation">:</span> action<span class="token punctuation">,</span>
    setTitle2<span class="token punctuation">:</span> action<span class="token punctuation">.</span>bound
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ä¹Ÿè®¸æ‚¨çš„é¡¹ç›®ä¸­å·²ç»æœ‰ç±»ï¼Œä½†è¿˜æ²¡æœ‰å¯ç”¨è£…é¥°å™¨è¯­æ³•ã€‚ä¸ç”¨æ‹…å¿ƒï¼Œä½¿ç”¨ MobX 4 å¯ä»¥è®©æ‚¨ä¸èµ°å›å¤´è·¯</span>
<span class="token comment">// ä½œä¸ºåœ¨ constructor ä¸­ä½¿ç”¨`extendObservable`çš„æ›¿ä»£ï¼Œåªéœ€è¦åœ¨`mobx.decorate`ä¸­å£°æ˜ç›¸å…³å­—æ®µå³å¯å¢å¼ºåŸå‹:</span>
<span class="token keyword">class</span> <span class="token class-name">Todo</span> <span class="token punctuation">{</span>
    title <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span>
    promise <span class="token operator">=</span> somePromise

    <span class="token keyword">get</span> <span class="token function">difficulty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">.</span>length
    <span class="token punctuation">}</span>
    <span class="token keyword">get</span> <span class="token function">expensive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">somethingExpensive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> t
    <span class="token punctuation">}</span>
    <span class="token function">setTitle2</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> t
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">decorate</span><span class="token punctuation">(</span>Todo<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> observable<span class="token punctuation">,</span>
    ref<span class="token punctuation">:</span> observable<span class="token punctuation">.</span>ref<span class="token punctuation">,</span>
    expensive<span class="token punctuation">:</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{</span> requiresReaction<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    setTitle<span class="token punctuation">:</span> action<span class="token punctuation">,</span>
    setTitle2<span class="token punctuation">:</span> action<span class="token punctuation">.</span>bound
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><h3 id="å¯è§‚å¯Ÿçš„å·¥å‚å‡½æ•°å·²ç»è¢«æ¸…é™¤"><a href="#å¯è§‚å¯Ÿçš„å·¥å‚å‡½æ•°å·²ç»è¢«æ¸…é™¤" aria-hidden="true" class="header-anchor">#</a> å¯è§‚å¯Ÿçš„å·¥å‚å‡½æ•°å·²ç»è¢«æ¸…é™¤</h3> <table><thead><tr><th>æ—§API</th> <th>æ–°API</th> <th>æ³¨é‡Š</th></tr></thead> <tbody><tr><td><code>observable(primitive value)</code></td> <td><code>observable.box(primitive value)</code></td> <td>ç”±äºè£…é¥°å™¨@observableä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œï¼ˆä¹Ÿé€‚ç”¨äºåŸå§‹å€¼ï¼‰ã€‚å¦‚æœè¯¥å€¼ä¸ºçº¯å¯¹è±¡ï¼Œæ•°ç»„æˆ–ES6 Mapï¼Œobservable(value)ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨</td></tr> <tr><td><code>observable(class instance)</code></td> <td><code>observable.box(class instance)</code></td> <td>ç”±äºè£…é¥°å™¨@observableä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œï¼ˆä¹Ÿé€‚ç”¨äºåŸå§‹å€¼ï¼‰ã€‚å¦‚æœè¯¥å€¼ä¸ºçº¯å¯¹è±¡ï¼Œæ•°ç»„æˆ–ES6 Mapï¼Œobservable(value)ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨</td></tr> <tr><td><code>observable.shallowArray(values)</code></td> <td><code>observable.array(values, { deep: false })</code></td> <td></td></tr> <tr><td><code>observable.shallowMap(values)</code></td> <td><code>observable.map(values, { deep: false })</code></td> <td></td></tr> <tr><td><code>observable.shallowObject(values)</code></td> <td><code>observable.object(values, {}, { deep: false })</code></td> <td>æ³¨æ„éœ€è¦å°†ç©ºå¯¹è±¡ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œå…¶ä¸­å¯ä»¥åŒ…å«è£…é¥°å™¨ï¼ˆè¯·å‚è§ä¸Šæ–‡ï¼‰</td></tr> <tr><td><code>extendObservable(target, props, moreProps, evenMoreProps)</code></td> <td><code>extendObservable(target, {...props, ...moreProps, ...evenMoreProps})</code></td> <td>extendObservableä¸å†æ¥å—å¤šä¸ªå‚æ•°ã€‚è€Œæ˜¯å…ˆåˆå¹¶åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­å†è§£æ„èµ‹å€¼ã€‚</td></tr> <tr><td><code>extendShallowObservable(target, props)</code></td> <td><code>extendObservable(target, props, {}, { deep: false })</code></td> <td>æ³¨æ„éœ€è¦å°†ç©ºå¯¹è±¡ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå…¶ä¸­å¯ä»¥åŒ…å«è£…é¥°å™¨ï¼ˆè¯·å‚è§å‘è¡Œè¯´æ˜ï¼‰</td></tr> <tr><td><code>@computed.equals(compareFn)</code></td> <td><code>@computed({ equals: compareFn })</code></td> <td></td></tr> <tr><td><code>autorunAsync(fn, delay)</code></td> <td><code>autorun(fn, { delay: delay })</code></td> <td></td></tr> <tr><td><code>autorun(name, fn)</code></td> <td><code>autorun(fn, { name: name })</code></td> <td></td></tr> <tr><td><code>when(name, predicate, effect)</code></td> <td><code>when(predicate, effect, { name: name })</code></td> <td></td></tr> <tr><td><code>reaction(name, expr, effect)</code></td> <td><code>reaction(expr, effect, { name: name })</code></td> <td></td></tr> <tr><td><code>isComputed(thing, prop)</code></td> <td><code>isComputedProp(thing, prop)</code></td> <td>isComputed(thing) ä»ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨</td></tr> <tr><td><code>isObservable(thing, prop)</code></td> <td><code>isObservableProp(thing, prop)</code></td> <td>isObservable(thing) ä»ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨</td></tr> <tr><td><code>new Atom(name, fn, fn)</code></td> <td><code>createAtom(name, fn, fn)</code></td> <td>Atom ç±»ä¸å†ç›´æ¥ä»åŒ…ä¸­å…¬å¼€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç°åœ¨å­˜åœ¨å¯ä»¥åœ¨ä»»ä½•MobXå¯è§‚å¯Ÿå¯¹è±¡ä¸Šä½¿ç”¨çš„å…¨å±€å‡½æ•°onBecomeObservedå¹¶ä¸”onBecomeUnobservedï¼Œå› æ­¤åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½æ ¹æœ¬ä¸éœ€è¦åˆ›å»ºAtom çš„å®ä¾‹ã€‚</td></tr> <tr><td><code>computed(fn, { struct: true }) / computed(fn, { compareStructural: true })</code></td> <td><code>computed(fn, { equals: comparer.structural })</code></td> <td></td></tr></tbody></table> <h2 id="å…¶ä»–æ”¹åŠ¨"><a href="#å…¶ä»–æ”¹åŠ¨" aria-hidden="true" class="header-anchor">#</a> å…¶ä»–æ”¹åŠ¨</h2> <p>MobX ç°åœ¨éœ€è¦<code>Map</code>åœ¨å…¨å±€èŒƒå›´å†…å¯ç”¨ï¼Œå› æ­¤éœ€è¦ç¡®ä¿åœ¨æ—§ç‰ˆæµè§ˆå™¨ä¸­çš„å…¼å®¹æ€§ï¼ˆç›®å‰æ”¯æŒçš„æ˜¯IE 10åŠæ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚å¦‚æœæ‚¨ä½¿ç”¨äº†<code>observable.map()</code>å’Œåºåˆ—åŒ–ï¼Œå¯èƒ½éœ€è¦æ›´æ–°ä»£ç ã€‚ <code>observableMap.toJS()</code>ç°åœ¨ä¼šè¿”å›ä¸€ä¸ª<code>Map</code>çš„æ™®é€šå®ä¾‹ã€‚å¦‚æœå¸Œæœ›è½¬æ¢ä¸ºæ™®é€š JavaScript å¯¹è±¡ï¼Œè¯·ä½¿ç”¨<code>observableMap.toJSON()</code></p> <p><code>extendObservable</code>ä¸èƒ½å†é‡æ–°å£°æ˜ç°æœ‰å±æ€§ï¼Œåªèƒ½å¼•å…¥æ–°å±æ€§ã€‚åº”è¯¥æ”¹ç”¨<code>set</code>å¼•å…¥æ–°å±æ€§æˆ–æ›´æ–°ç°æœ‰å±æ€§</p> <p>æ‰€æœ‰å¯è¿­ä»£çš„å¯¹è±¡éƒ½ä¸å†åˆ›å»ºæ•°ç»„ä½œä¸ºè¿­ä»£å™¨ï¼Œè€Œåªæ˜¯åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„è¿­ä»£å™¨ï¼Œä»¥æ±‚ä¸å®˜æ–¹è§„èŒƒæ›´åŠ ç´§å¯†åœ°å¯¹é½ã€‚å› æ­¤ï¼Œä»¥å‰çš„<code>observableMap.values()</code>å°†è¿”å›ä¸€ä¸ªæ•°ç»„ä½œä¸ºè¿­ä»£å™¨ï¼Œä½†æ˜¯ç°åœ¨å®ƒå°†åªè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€‚æ‰€ä»¥ä½ ä¸èƒ½å†åšç±»ä¼¼<code>observableMap.values().map(fn)</code>çš„æ“ä½œã€‚è€Œæ˜¯ä½¿ç”¨<code>Array.from(observableMap.values()).map(fn)</code>æˆ–<code>mobx.values(observableMap).map(fn)</code>ã€‚å—å½±å“çš„è¿­ä»£å™¨æœ‰ï¼š1.å¯è§‚å¯Ÿæ•°ç»„çš„é»˜è®¤è¿­ä»£å™¨ã€‚2.å¯è§‚å¯Ÿæ˜ å°„çš„é»˜è®¤è¿­ä»£å™¨ã€‚åŒ…æ‹¬<code>observableMap.entries()</code>ï¼Œ<code>observableMap.keys()</code>å’Œ<code>observableMap.values()</code>ã€‚</p> <p>ä¼ é€’ç»™<code>spy</code>å¤„ç†å‡½æ•°çš„å‚æ•°å·²ç¨ä½œæ›´æ”¹ã€‚</p> <p>å¦‚æœ<code>reportObserved</code>åœ¨ååº”æ€§ä¸Šä¸‹æ–‡ä¹‹å¤–è¢«è§¦å‘ï¼Œåœ¨è‡ªå»º atom ä¸­è°ƒç”¨<code>reportObserved()</code>å°†ä¸å†è§¦å‘é’©å­ã€‚</p></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°: </span> <span class="time">5/31/2020, 3:25:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/2005/20200528A.html" class="prev">
          ã€ç¿»è¯‘ã€‘MobX 4ï¼šæ›´ä¼˜ç§€ã€ç®€æ˜“ã€å¿«æ·ã€è½»ä¾¿
        </a></span> <span class="next"><a href="/2004/20200409A.html">
          ã€å½’çº³ã€‘ES6 æ–°å¢çš„æ•°æ®ç±»å‹
        </a>
        â†’
      </span></p></div> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.20586f85.js" defer></script><script src="/assets/js/3.a975d71c.js" defer></script><script src="/assets/js/1.f9715dde.js" defer></script><script src="/assets/js/117.2b92a260.js" defer></script>
  </body>
</html>
